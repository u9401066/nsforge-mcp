# Neurosymbolic Forge è¨­è¨ˆæ–‡æª”

> **å°ˆæ¡ˆåç¨±**: Neurosymbolic Forge (NSForge)  
> **å¥—ä»¶åç¨±**: `nsforge-mcp`  
> **ç‰ˆæœ¬**: 0.1.0 (Draft)  
> **æ—¥æœŸ**: 2026-01-01  
> **ç‹€æ…‹**: è¨­è¨ˆéšæ®µ
>
> *Where Neural Meets Symbolic*

---

## ç›®éŒ„

1. [å°ˆæ¡ˆæ¦‚è¿°](#1-å°ˆæ¡ˆæ¦‚è¿°)
2. [èƒŒæ™¯çŸ¥è­˜](#2-èƒŒæ™¯çŸ¥è­˜)
3. [ç³»çµ±æ¶æ§‹](#3-ç³»çµ±æ¶æ§‹)
4. [æ ¸å¿ƒçµ„ä»¶](#4-æ ¸å¿ƒçµ„ä»¶)
5. [MCP å·¥å…·å®šç¾©](#5-mcp-å·¥å…·å®šç¾©)
6. [ä½¿ç”¨å ´æ™¯èˆ‡ç¯„ä¾‹](#6-ä½¿ç”¨å ´æ™¯èˆ‡ç¯„ä¾‹)
7. [æŠ€è¡“é¸å‹](#7-æŠ€è¡“é¸å‹)
8. [å¯¦ä½œè¨ˆåŠƒ](#8-å¯¦ä½œè¨ˆåŠƒ)
9. [åƒè€ƒè³‡æ–™](#9-åƒè€ƒè³‡æ–™)

---

## 1. å°ˆæ¡ˆæ¦‚è¿°

### 1.1 ç›®æ¨™

å»ºç«‹ä¸€å€‹ MCP (Model Context Protocol) Serverï¼Œæä¾›**ç¬¦è™Ÿæ¨ç†**èƒ½åŠ›ï¼Œè®“ AI Agent èƒ½å¤ ï¼š

- é€²è¡Œç²¾ç¢ºçš„æ•¸å­¸ç¬¦è™Ÿé‹ç®—ï¼ˆå¾®ç©åˆ†ã€ä»£æ•¸ã€æ–¹ç¨‹æ±‚è§£ç­‰ï¼‰
- è™•ç†ç‰©ç†ã€åŒ–å­¸ã€ç†±åŠ›å­¸ç­‰é ˜åŸŸçš„å…¬å¼æ¨å°
- åˆ†ææ¼”ç®—æ³•è¤‡é›œåº¦
- é©—è­‰æ¨å°éç¨‹çš„æ­£ç¢ºæ€§

### 1.2 æ ¸å¿ƒåƒ¹å€¼

| å‚³çµ± LLM æ–¹å¼ | æœ¬å°ˆæ¡ˆæ–¹å¼ |
|--------------|-----------|
| LLM ç›´æ¥ç”Ÿæˆç­”æ¡ˆ | LLM ç”Ÿæˆçµæ§‹åŒ–è«‹æ±‚ â†’ ç¬¦è™Ÿå¼•æ“è¨ˆç®— |
| æ¯æ¬¡çµæœå¯èƒ½ä¸åŒ | **ç›¸åŒè¼¸å…¥ = ç›¸åŒè¼¸å‡ºï¼ˆé«˜åº¦å¯å†ç¾æ€§ï¼‰** |
| å¯èƒ½è¨ˆç®—éŒ¯èª¤ | **æ•¸å­¸æ­£ç¢ºæ€§æœ‰ä¿éšœ** |
| æ¨å°éç¨‹ä¸é€æ˜ | **å®Œæ•´æ¨å°æ­¥é©Ÿå¯è¿½è¹¤** |
| ç„¡æ³•é©—è­‰ | **å¯åå‘é©—è­‰çµæœ** |

### 1.3 è¨­è¨ˆå“²å­¸

```
Neural-Symbolic AI æ ¸å¿ƒç†å¿µï¼š

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                                                                 â”‚
â”‚   LLM (Neural)              Engine (Symbolic)                   â”‚
â”‚   â•â•â•â•â•â•â•â•â•â•â•â•              â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•                   â”‚
â”‚                                                                 â”‚
â”‚   âœ“ ç†è§£æ¨¡ç³Šçš„è‡ªç„¶èªè¨€      âœ“ ç²¾ç¢ºåŸ·è¡Œé‚è¼¯é‹ç®—                  â”‚
â”‚   âœ“ éˆæ´»è™•ç†å¤šç¨®è¼¸å…¥æ ¼å¼    âœ“ ä¿è­‰è¨ˆç®—æ­£ç¢ºæ€§                    â”‚
â”‚   âœ“ è§£é‡‹çµæœçµ¦ç”¨æˆ¶          âœ“ æä¾›æ¨å°æ­¥é©Ÿ                      â”‚
â”‚                                                                 â”‚
â”‚   çµåˆå¾Œï¼šLLM åšã€Œç†è§£èˆ‡ç¿»è­¯ã€ï¼ŒEngine åšã€Œç²¾ç¢ºè¨ˆç®—ã€           â”‚
â”‚                                                                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## 2. èƒŒæ™¯çŸ¥è­˜

### 2.1 ä»€éº¼æ˜¯ç¬¦è™Ÿæ¨ç†ï¼Ÿ

ç¬¦è™Ÿæ¨ç†ï¼ˆSymbolic Reasoningï¼‰æ˜¯ä½¿ç”¨**æ˜ç¢ºçš„ç¬¦è™Ÿå’Œè¦å‰‡**é€²è¡Œé‚è¼¯é‹ç®—çš„æ–¹æ³•ã€‚

#### ç¬¦è™Ÿè¡¨ç¤º vs ç¬¦è™Ÿæ¨ç†

| æ¦‚å¿µ | èªªæ˜ | ç¯„ä¾‹ |
|------|------|------|
| **ç¬¦è™Ÿè¡¨ç¤º** | ç”¨çµæ§‹åŒ–ç¬¦è™Ÿæè¿°çŸ¥è­˜ï¼ˆéœæ…‹ï¼‰ | `âˆ« xÂ² dx` å¯«åœ¨ç´™ä¸Š |
| **ç¬¦è™Ÿæ¨ç†** | å°ç¬¦è™ŸåŸ·è¡Œé‚è¼¯é‹ç®—ï¼ˆå‹•æ…‹ï¼‰ | è¨ˆç®—å‡º `xÂ³/3 + C` |

#### èˆ‡ Pseudo Code çš„é—œä¿‚

```
Pseudo Code â”€â”€â†’ Parser â”€â”€â†’ çµæ§‹åŒ–è¡¨ç¤º â”€â”€â†’ åŸ·è¡Œå¼•æ“ â”€â”€â†’ çµæœ
   (éœæ…‹)                    (AST)          (å‹•æ…‹)      (ç¢ºå®š)
```

- Pseudo Code æœ¬èº«åªæ˜¯ç¬¦è™Ÿã€Œè¡¨ç¤ºã€
- éœ€è¦ Parser è§£æ + Engine åŸ·è¡Œï¼Œæ‰ç”¢ç”Ÿã€Œæ¨ç†ã€

### 2.2 ç¾æœ‰ç³»çµ±åƒè€ƒ

#### Wolfram Alpha / Mathematica

```
è‡ªç„¶èªè¨€ â”€â”€â†’ NL Parser â”€â”€â†’ Wolfram Language â”€â”€â†’ Symbolic Engine â”€â”€â†’ çµæœ
                          ï¼ˆç¬¦è™Ÿè¡¨ç¤ºï¼‰          ï¼ˆ50+å¹´ç ”ç©¶ï¼‰
```

- å„ªé»ï¼šæ¶µè“‹ç¯„åœå»£ã€çµæœç²¾ç¢º
- ç¼ºé»ï¼šé–‰æºã€éœ€è¦æˆæ¬Š

#### Code Interpreter (OpenAI)

```
ç”¨æˆ¶è«‹æ±‚ â”€â”€â†’ LLM ç”Ÿæˆ Python â”€â”€â†’ Runtime åŸ·è¡Œ â”€â”€â†’ çµæœ
                              ï¼ˆå« SymPyï¼‰
```

- å„ªé»ï¼šéˆæ´»ã€é–‹æ”¾
- ç¼ºé»ï¼šLLM ç”Ÿæˆä»£ç¢¼å¯èƒ½å‡ºéŒ¯

#### Semantic Kernel (Microsoft)

```
Kernel
â”œâ”€â”€ Semantic Functions (LLM prompts)
â”œâ”€â”€ Native Functions (ç¨‹å¼ç¢¼)
â””â”€â”€ Planner (è‡ªå‹•è¦åŠƒ)
```

- å„ªé»ï¼šçµ±ä¸€æ¡†æ¶ã€æ˜“æ–¼æ“´å±•
- ç¼ºé»ï¼šéœ€è¦è‡ªè¡Œæ•´åˆè¨ˆç®—å¼•æ“

---

## 3. ç³»çµ±æ¶æ§‹

### 3.1 æ•´é«”æ¶æ§‹åœ–

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                  Neurosymbolic Forge (NSForge) MCP Server                   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                             â”‚
â”‚   AI Agent (LLM)                                                            â”‚
â”‚      â”‚                                                                      â”‚
â”‚      â”‚ MCP Protocol (JSON-RPC)                                              â”‚
â”‚      â–¼                                                                      â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚  â”‚                        MCP Server                                   â”‚    â”‚
â”‚  â”‚                                                                     â”‚    â”‚
â”‚  â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚    â”‚
â”‚  â”‚   â”‚                 Tool Layer (å·¥å…·å±¤)                         â”‚   â”‚    â”‚
â”‚  â”‚   â”‚                                                             â”‚   â”‚    â”‚
â”‚  â”‚   â”‚  symbolic_calculate  â”‚  physics_formula  â”‚  verify_derivationâ”‚   â”‚    â”‚
â”‚  â”‚   â”‚  chemistry_calc      â”‚  algorithm_analyzeâ”‚  explain_concept â”‚   â”‚    â”‚
â”‚  â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚    â”‚
â”‚  â”‚                              â”‚                                      â”‚    â”‚
â”‚  â”‚                              â–¼                                      â”‚    â”‚
â”‚  â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚    â”‚
â”‚  â”‚   â”‚              Parser Layer (è§£æå±¤)                          â”‚   â”‚    â”‚
â”‚  â”‚   â”‚                                                             â”‚   â”‚    â”‚
â”‚  â”‚   â”‚  â€¢ LaTeX Parser       â€¢ ASCII Math Parser                   â”‚   â”‚    â”‚
â”‚  â”‚   â”‚  â€¢ Natural Language   â€¢ Expression Tokenizer                â”‚   â”‚    â”‚
â”‚  â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚    â”‚
â”‚  â”‚                              â”‚                                      â”‚    â”‚
â”‚  â”‚                              â–¼                                      â”‚    â”‚
â”‚  â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚    â”‚
â”‚  â”‚   â”‚              Engine Layer (å¼•æ“å±¤)                          â”‚   â”‚    â”‚
â”‚  â”‚   â”‚                                                             â”‚   â”‚    â”‚
â”‚  â”‚   â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚   â”‚    â”‚
â”‚  â”‚   â”‚  â”‚  SymPy    â”‚ â”‚ SciPy     â”‚ â”‚ Pint      â”‚ â”‚ Rule      â”‚   â”‚   â”‚    â”‚
â”‚  â”‚   â”‚  â”‚ (ç¬¦è™Ÿ)    â”‚ â”‚ (æ•¸å€¼)    â”‚ â”‚ (å–®ä½)    â”‚ â”‚ Engine    â”‚   â”‚   â”‚    â”‚
â”‚  â”‚   â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚   â”‚    â”‚
â”‚  â”‚   â”‚                                                             â”‚   â”‚    â”‚
â”‚  â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚    â”‚
â”‚  â”‚                              â”‚                                      â”‚    â”‚
â”‚  â”‚                              â–¼                                      â”‚    â”‚
â”‚  â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚    â”‚
â”‚  â”‚   â”‚              Knowledge Layer (çŸ¥è­˜å±¤)                       â”‚   â”‚    â”‚
â”‚  â”‚   â”‚                                                             â”‚   â”‚    â”‚
â”‚  â”‚   â”‚  â€¢ ç‰©ç†å…¬å¼åº«     â€¢ åŒ–å­¸åæ‡‰è¦å‰‡    â€¢ æ•¸å­¸å®šç†åº«           â”‚   â”‚    â”‚
â”‚  â”‚   â”‚  â€¢ å–®ä½è½‰æ›è¡¨     â€¢ å¸¸æ•¸å®šç¾©        â€¢ æ¼”ç®—æ³•æ¨¡å¼åº«         â”‚   â”‚    â”‚
â”‚  â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚    â”‚
â”‚  â”‚                              â”‚                                      â”‚    â”‚
â”‚  â”‚                              â–¼                                      â”‚    â”‚
â”‚  â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚    â”‚
â”‚  â”‚   â”‚           ğŸ†• Derivation Planner (æ¨å°è¦åŠƒå±¤)                â”‚   â”‚    â”‚
â”‚  â”‚   â”‚                                                             â”‚   â”‚    â”‚
â”‚  â”‚   â”‚  â€¢ æ¨å°ç­–ç•¥é¸æ“‡   â€¢ å…¬å¼ä¾è³´åœ–è­œ    â€¢ å¤šæ­¥é©Ÿç·¨æ’           â”‚   â”‚    â”‚
â”‚  â”‚   â”‚  â€¢ ä¸­é–“çµæœç®¡ç†   â€¢ æ¨å°æ¨¡æ¿åº«      â€¢ äº¤äº’å¼æ¾„æ¸…           â”‚   â”‚    â”‚
â”‚  â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚    â”‚
â”‚  â”‚                                                                     â”‚    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â”‚                                                                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 3.2 è³‡æ–™æµç¨‹

```
ç”¨æˆ¶è‡ªç„¶èªè¨€
    â”‚
    â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   AI Agent      â”‚  ç†è§£æ„åœ–ï¼Œæ±ºå®šä½¿ç”¨å“ªå€‹å·¥å…·
â”‚   (LLM)         â”‚  
â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚ MCP Tool Call
         â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   Tool Layer    â”‚  æ¥æ”¶çµæ§‹åŒ–è«‹æ±‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚
         â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Parser Layer   â”‚  è§£æè¡¨é”å¼ï¼ˆLaTeX/ASCII/NLï¼‰
â”‚                 â”‚  ç”Ÿæˆ AST æˆ–çµæ§‹åŒ–å‘½ä»¤
â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚
         â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Engine Layer   â”‚  åŸ·è¡Œç¬¦è™Ÿé‹ç®—
â”‚  (SymPy etc.)   â”‚  ç”Ÿæˆæ¨å°æ­¥é©Ÿ
â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚
         â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Response       â”‚  æ ¼å¼åŒ–çµæœ
â”‚  Formatter      â”‚  åŒ…å« LaTeXã€æ­¥é©Ÿã€é©—è­‰
â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚
         â–¼
    è¿”å›çµ¦ Agent
```

---

## 3.3 ğŸ†• å¤šæ­¥æ¨å°æ¶æ§‹ï¼ˆé—œéµè¨­è¨ˆï¼‰

### å•é¡Œï¼šSymPy çš„ä¾·é™æ€§

SymPy æ˜¯å„ªç§€çš„ç¬¦è™Ÿè¨ˆç®—å¼•æ“ï¼Œä½†å®ƒæ˜¯ã€ŒåŸ·è¡Œå™¨ã€è€Œéã€Œè¦åŠƒå™¨ã€ï¼š

```
SymPy èƒ½åšçš„ï¼š                         SymPy ä¸æœƒåšçš„ï¼š
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€                       â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
âœ… diff(x**3, x) â†’ 3xÂ²                 âŒ ä¸çŸ¥é“ã€Œä¸‹ä¸€æ­¥è©²ç”¨ä»€éº¼å…¬å¼ã€
âœ… integrate(x**2, x) â†’ xÂ³/3           âŒ ä¸çŸ¥é“ã€Œé€™å€‹çµæœè¦ä»£å…¥å“ªè£¡ã€
âœ… solve(x**2 - 4, x) â†’ [-2, 2]        âŒ ä¸çŸ¥é“ã€Œé‚„éœ€è¦å“ªäº›ä¸­é–“æ­¥é©Ÿã€
âœ… simplify(expr)                      âŒ ä¸çŸ¥é“ã€Œä»€éº¼æ™‚å€™æ¨å°å®Œæˆã€
```

### è§£æ±ºæ–¹æ¡ˆï¼šDerivation Plannerï¼ˆæ¨å°è¦åŠƒå™¨ï¼‰

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                        å¤šæ­¥æ¨å°æ¶æ§‹                                         â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                             â”‚
â”‚   å•é¡Œè¼¸å…¥                                                                  â”‚
â”‚      â”‚                                                                      â”‚
â”‚      â–¼                                                                      â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚  â”‚              Problem Analyzerï¼ˆå•é¡Œåˆ†æå™¨ï¼‰                         â”‚    â”‚
â”‚  â”‚                                                                     â”‚    â”‚
â”‚  â”‚  â€¢ è­˜åˆ¥å•é¡Œé¡å‹ï¼ˆç¢°æ’ã€ç†±åŠ›å­¸ã€é›»è·¯...ï¼‰                            â”‚    â”‚
â”‚  â”‚  â€¢ æå–å·²çŸ¥é‡å’ŒæœªçŸ¥é‡                                               â”‚    â”‚
â”‚  â”‚  â€¢ è­˜åˆ¥éœ€è¦çš„ç‰©ç†å®šå¾‹/å…¬å¼                                          â”‚    â”‚
â”‚  â”‚  â€¢ æª¢æŸ¥åƒæ•¸å®Œæ•´æ€§                                                   â”‚    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â”‚      â”‚                                                                      â”‚
â”‚      â–¼                                                                      â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚  â”‚              Derivation Plannerï¼ˆæ¨å°è¦åŠƒå™¨ï¼‰                       â”‚    â”‚
â”‚  â”‚                                                                     â”‚    â”‚
â”‚  â”‚  è¼¸å…¥ï¼šå•é¡Œé¡å‹ + å·²çŸ¥/æœªçŸ¥é‡ + å¯ç”¨å…¬å¼                            â”‚    â”‚
â”‚  â”‚  è¼¸å‡ºï¼šæ¨å°è¨ˆåŠƒï¼ˆæ­¥é©Ÿåºåˆ—ï¼‰                                         â”‚    â”‚
â”‚  â”‚                                                                     â”‚    â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚    â”‚
â”‚  â”‚  â”‚  Formula Knowledge Graphï¼ˆå…¬å¼çŸ¥è­˜åœ–è­œï¼‰                    â”‚    â”‚    â”‚
â”‚  â”‚  â”‚                                                             â”‚    â”‚    â”‚
â”‚  â”‚  â”‚   å‹•é‡å®ˆæ† â”€â”€â”€â”€â”€â”€â†’ ç¢°æ’å¾Œé€Ÿåº¦                               â”‚    â”‚    â”‚
â”‚  â”‚  â”‚      â”‚                  â”‚                                   â”‚    â”‚    â”‚
â”‚  â”‚  â”‚      â–¼                  â–¼                                   â”‚    â”‚    â”‚
â”‚  â”‚  â”‚   èƒ½é‡å®ˆæ† â”€â”€â”€â”€â”€â”€â†’ èƒ½é‡æå¤±                                 â”‚    â”‚    â”‚
â”‚  â”‚  â”‚      â”‚                  â”‚                                   â”‚    â”‚    â”‚
â”‚  â”‚  â”‚      â–¼                  â–¼                                   â”‚    â”‚    â”‚
â”‚  â”‚  â”‚   å½ˆç°§åŠ›å­¸ â†â”€â”€â”€â”€â”€ é€Ÿåº¦è®ŠåŒ– â”€â”€â”€â†’ å¼µåŠ›è¨ˆç®—                    â”‚    â”‚    â”‚
â”‚  â”‚  â”‚                                                             â”‚    â”‚    â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â”‚      â”‚                                                                      â”‚
â”‚      â–¼                                                                      â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚  â”‚              Step Executorï¼ˆæ­¥é©ŸåŸ·è¡Œå™¨ï¼‰                            â”‚    â”‚
â”‚  â”‚                                                                     â”‚    â”‚
â”‚  â”‚  For each step in plan:                                             â”‚    â”‚
â”‚  â”‚    1. æº–å‚™è¼¸å…¥ï¼ˆå¾å‰æ­¥çµæœæˆ–å·²çŸ¥é‡ï¼‰                                â”‚    â”‚
â”‚  â”‚    2. å‘¼å« SymPy åŸ·è¡Œè¨ˆç®—                                           â”‚    â”‚
â”‚  â”‚    3. é©—è­‰çµæœï¼ˆç¶­åº¦æª¢æŸ¥ã€åˆç†æ€§ï¼‰                                  â”‚    â”‚
â”‚  â”‚    4. å„²å­˜ä¸­é–“çµæœ                                                  â”‚    â”‚
â”‚  â”‚    5. æ›´æ–°æ¨å°ç‹€æ…‹                                                  â”‚    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â”‚      â”‚                                                                      â”‚
â”‚      â–¼                                                                      â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚  â”‚              Result Assemblerï¼ˆçµæœçµ„è£å™¨ï¼‰                         â”‚    â”‚
â”‚  â”‚                                                                     â”‚    â”‚
â”‚  â”‚  â€¢ çµ„åˆæ‰€æœ‰æ­¥é©Ÿçš„æ¨å°éç¨‹                                           â”‚    â”‚
â”‚  â”‚  â€¢ ç”Ÿæˆæœ€çµ‚è¡¨é”å¼                                                   â”‚    â”‚
â”‚  â”‚  â€¢ ç”¢ç”Ÿé©—è­‰ï¼ˆåå‘æ¨å°æª¢æŸ¥ï¼‰                                         â”‚    â”‚
â”‚  â”‚  â€¢ æ ¼å¼åŒ–è¼¸å‡ºï¼ˆLaTeX + æ­¥é©Ÿèªªæ˜ï¼‰                                   â”‚    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â”‚                                                                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### å…¬å¼çŸ¥è­˜åœ–è­œï¼ˆFormula Knowledge Graphï¼‰

é€™æ˜¯å¤šæ­¥æ¨å°çš„æ ¸å¿ƒï¼šè¨˜éŒ„å…¬å¼ä¹‹é–“çš„ã€Œä¾è³´é—œä¿‚ã€å’Œã€Œè½‰æ›è·¯å¾‘ã€ã€‚

```python
# çŸ¥è­˜åœ–è­œçµæ§‹ç¯„ä¾‹
formula_graph = {
    "collision_velocity": {
        "formula": "v_final = (m1*v1 + m2*v2) / (m1 + m2)",
        "inputs": ["m1", "m2", "v1", "v2"],
        "outputs": ["v_final"],
        "prerequisites": [],  # ä¸éœ€è¦å‰ç½®å…¬å¼
        "domain": "mechanics",
        "tags": ["collision", "momentum"]
    },
    
    "velocity_change": {
        "formula": "delta_v = v_initial - v_final",
        "inputs": ["v_initial", "v_final"],
        "outputs": ["delta_v"],
        "prerequisites": ["collision_velocity"],  # éœ€è¦å…ˆç®—ç¢°æ’å¾Œé€Ÿåº¦
        "domain": "mechanics",
        "tags": ["kinematics"]
    },
    
    "spring_extension": {
        "formula": "x = delta_v * sqrt(m/k)",
        "inputs": ["delta_v", "m", "k"],
        "outputs": ["x"],
        "prerequisites": ["velocity_change"],  # éœ€è¦å…ˆç®—é€Ÿåº¦è®ŠåŒ–
        "domain": "mechanics",
        "tags": ["spring", "energy"]
    },
    
    "spring_force": {
        "formula": "F = k * x",
        "inputs": ["k", "x"],
        "outputs": ["F"],
        "prerequisites": ["spring_extension"],
        "domain": "mechanics",
        "tags": ["spring", "force"]
    }
}
```

### æ¨å°è¨ˆåŠƒç”Ÿæˆæ¼”ç®—æ³•

```python
class DerivationPlanner:
    def __init__(self, formula_graph):
        self.graph = formula_graph
    
    def plan_derivation(self, known_vars: set, target_var: str) -> List[Step]:
        """
        ä½¿ç”¨ BFS/DFS åœ¨å…¬å¼åœ–è­œä¸­æ‰¾å‡ºæ¨å°è·¯å¾‘
        
        Args:
            known_vars: å·²çŸ¥è®Šæ•¸é›†åˆ {"m1", "m2", "v1", "v2", "k"}
            target_var: ç›®æ¨™è®Šæ•¸ "F" (å¼µåŠ›)
        
        Returns:
            æ¨å°æ­¥é©Ÿåˆ—è¡¨
        """
        # æ‰¾å‡ºèƒ½ç”¢ç”Ÿ target_var çš„å…¬å¼
        target_formulas = self._find_formulas_producing(target_var)
        
        plan = []
        for formula in target_formulas:
            # æª¢æŸ¥é€™å€‹å…¬å¼çš„è¼¸å…¥æ˜¯å¦éƒ½å¯å¾—
            missing = set(formula["inputs"]) - known_vars
            
            if not missing:
                # æ‰€æœ‰è¼¸å…¥éƒ½å·²çŸ¥ï¼Œå¯ä»¥ç›´æ¥è¨ˆç®—
                plan.append(Step(formula=formula, reason="ç›´æ¥è¨ˆç®—"))
            else:
                # éœ€è¦å…ˆæ¨å°ç¼ºå°‘çš„è®Šæ•¸
                for var in missing:
                    sub_plan = self.plan_derivation(known_vars, var)
                    plan.extend(sub_plan)
                    known_vars.add(var)  # ç¾åœ¨é€™å€‹è®Šæ•¸å·²çŸ¥äº†
                plan.append(Step(formula=formula, reason="ä»£å…¥å‰æ­¥çµæœ"))
        
        return plan
    
    def check_completeness(self, known_vars: set, target_var: str) -> dict:
        """
        æª¢æŸ¥æ˜¯å¦æœ‰è¶³å¤ çš„å·²çŸ¥é‡ä¾†æ¨å°ç›®æ¨™
        
        Returns:
            {
                "complete": True/False,
                "missing": ["var1", "var2"],  # ç¼ºå°‘çš„è®Šæ•¸
                "suggestions": ["å¯ä»¥å‡è¨­...", "éœ€è¦ç”¨æˆ¶æä¾›..."]
            }
        """
        # ... åˆ†æé‚è¼¯
```

### æ¨å°æ¨¡æ¿ï¼ˆDerivation Templatesï¼‰

å°æ–¼å¸¸è¦‹å•é¡Œé¡å‹ï¼Œé å®šç¾©æ¨å°æµç¨‹ï¼š

```python
derivation_templates = {
    "collision_force": {
        "description": "ç¢°æ’éç¨‹ä¸­çš„åŠ›åˆ†æ",
        "steps": [
            {
                "name": "momentum_conservation",
                "description": "æ‡‰ç”¨å‹•é‡å®ˆæ†æ±‚ç¢°æ’å¾Œé€Ÿåº¦",
                "formula": "collision_velocity",
                "comment": "å‡è¨­ç¢°æ’æ™‚é–“æ¥µçŸ­ï¼Œå¤–åŠ›å¯å¿½ç•¥"
            },
            {
                "name": "velocity_change",
                "description": "è¨ˆç®—é€Ÿåº¦è®ŠåŒ–é‡",
                "formula": "velocity_change",
                "comment": "é€™æ˜¯äºº/ç‰©é«”éœ€è¦ç¶“æ­·çš„æ¸›é€Ÿ"
            },
            {
                "name": "deceleration_analysis",
                "description": "åˆ†ææ¸›é€Ÿéç¨‹",
                "formula": "spring_extension",
                "comment": "ç”¨èƒ½é‡å®ˆæ†æ±‚å®‰å…¨å¸¶ä¼¸é•·é‡"
            },
            {
                "name": "force_calculation",
                "description": "è¨ˆç®—æœ€å¤§å¼µåŠ›",
                "formula": "spring_force",
                "comment": "F = kxï¼Œåœ¨æœ€å¤§ä¼¸é•·æ™‚å¼µåŠ›æœ€å¤§"
            }
        ],
        "required_inputs": ["m1", "m2", "v", "m_person", "k"],
        "output": "F_max"
    },
    
    "thermodynamic_work": {
        "description": "ç†±åŠ›å­¸éç¨‹åšåŠŸè¨ˆç®—",
        "steps": [
            # ... é¡ä¼¼çµæ§‹
        ]
    }
}
```

### äº¤äº’å¼æ¾„æ¸…ï¼ˆInteractive Clarificationï¼‰

ç•¶æ¨å°ç„¡æ³•ç¹¼çºŒæ™‚ï¼Œç”¢ç”Ÿæœ‰æ„ç¾©çš„å•é¡Œï¼š

```python
class InteractiveClarifier:
    def generate_clarification(self, derivation_state) -> dict:
        """
        æ ¹æ“šæ¨å°ç‹€æ…‹ï¼Œç”Ÿæˆéœ€è¦æ¾„æ¸…çš„å•é¡Œ
        """
        if derivation_state.missing_vars:
            return {
                "type": "missing_parameters",
                "message": f"ç¼ºå°‘ä»¥ä¸‹åƒæ•¸ï¼š{derivation_state.missing_vars}",
                "questions": [
                    f"è«‹æä¾› {var} çš„å€¼æˆ–åˆç†ä¼°è¨ˆ" 
                    for var in derivation_state.missing_vars
                ],
                "suggestions": self._suggest_defaults(derivation_state)
            }
        
        if derivation_state.ambiguous_path:
            return {
                "type": "multiple_approaches",
                "message": "æœ‰å¤šç¨®æ¨å°æ–¹æ³•å¯ç”¨",
                "options": [
                    {"name": "æ–¹æ³•A", "description": "ä½¿ç”¨èƒ½é‡å®ˆæ†", "pros": "ç²¾ç¢º", "cons": "éœ€è¦æ›´å¤šåƒæ•¸"},
                    {"name": "æ–¹æ³•B", "description": "ä½¿ç”¨å‹•é‡-è¡é‡", "pros": "ç°¡å–®", "cons": "éœ€è¦å‡è¨­ç¢°æ’æ™‚é–“"}
                ],
                "question": "æ‚¨å¸Œæœ›ä½¿ç”¨å“ªç¨®æ–¹æ³•ï¼Ÿ"
            }
        
        if derivation_state.assumption_needed:
            return {
                "type": "assumption_required", 
                "message": "éœ€è¦åšå‡ºå‡è¨­æ‰èƒ½ç¹¼çºŒ",
                "assumptions": [
                    {"name": "ç†æƒ³å½ˆç°§", "description": "å®‰å…¨å¸¶ç‚ºç†æƒ³å½ˆç°§ï¼Œç„¡é˜»å°¼"},
                    {"name": "å‰›æ€§é€£æ¥", "description": "äººèˆ‡è»Šå‰›æ€§é€£æ¥ï¼ŒåŒé€Ÿé‹å‹•"}
                ],
                "question": "ä»¥ä¸Šå‡è¨­æ˜¯å¦åˆç†ï¼Ÿ"
            }
```

### å®Œæ•´ç¯„ä¾‹ï¼šè»Šè¼›ç¢°æ’å•é¡Œçš„å¤šæ­¥æ¨å°

```python
# è¼¸å…¥
problem = {
    "type": "collision_force_analysis",
    "known": {
        "m": "70 kg",      # äººçš„è³ªé‡
        "M1": "1500 kg",   # è»Š1è³ªé‡
        "M2": "2000 kg",   # è»Š2è³ªé‡
        "v": "50 km/h",    # åˆé€Ÿåº¦
        "theta": "45Â°",    # ç¢°æ’è§’åº¦
        "k": "5000 N/m",   # å®‰å…¨å¸¶å½ˆæ€§ä¿‚æ•¸
        "eta": "0.7"       # èƒ½é‡ä¿ç•™æ¯”ä¾‹
    },
    "find": ["T_max", "material_strength"]
}

# Derivation Planner è¼¸å‡ºçš„æ¨å°è¨ˆåŠƒ
derivation_plan = [
    Step(1, "å‹•é‡å®ˆæ†ï¼ˆç¢°æ’å¾Œé€Ÿåº¦ï¼‰", 
         formula="v' = M1*v*cos(Î¸) / (M1+M2)",
         inputs=["M1", "M2", "v", "theta"],
         output="v_final"),
    
    Step(2, "é€Ÿåº¦è®ŠåŒ–é‡",
         formula="Î”v = v*cos(Î¸) - v'",
         inputs=["v", "theta", "v_final"],
         output="delta_v"),
    
    Step(3, "èƒ½é‡å®ˆæ†ï¼ˆå®‰å…¨å¸¶ä¼¸é•·ï¼‰",
         formula="x = Î”v * sqrt(m/k)",
         inputs=["delta_v", "m", "k"],
         output="x"),
    
    Step(4, "æœ€å¤§å¼µåŠ›",
         formula="T_max = k * x = Î”v * sqrt(m*k)",
         inputs=["delta_v", "m", "k"],
         output="T_max"),
    
    Step(5, "ææ–™å¼·åº¦è¦æ±‚",
         formula="Ïƒ_required = T_max * SF",
         inputs=["T_max", "SF=3.0"],
         output="material_strength")
]

# æ¯ä¸€æ­¥éƒ½ç”± SymPy ç²¾ç¢ºåŸ·è¡Œ
for step in derivation_plan:
    result = sympy_engine.execute(step)
    step.result = result
    step.verification = sympy_engine.verify(result)
```

### é€™å€‹æ¶æ§‹è§£æ±ºäº†ä»€éº¼å•é¡Œï¼Ÿ

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                        å•é¡Œ â†’ è§£æ±ºæ–¹æ¡ˆ                                      â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                             â”‚
â”‚  âŒ å•é¡Œ 1ï¼šã€Œä¸‹ä¸€æ­¥è©²ç”¨ä»€éº¼å…¬å¼ï¼Ÿã€                                        â”‚
â”‚  âœ… è§£æ±ºï¼šFormula Knowledge Graph è¨˜éŒ„å…¬å¼ä¾è³´é—œä¿‚                          â”‚
â”‚          Derivation Planner è‡ªå‹•è¦åŠƒæ¨å°è·¯å¾‘                                â”‚
â”‚                                                                             â”‚
â”‚  âŒ å•é¡Œ 2ï¼šã€Œé€™å€‹çµæœè¦ä»£å…¥å“ªè£¡ï¼Ÿã€                                        â”‚
â”‚  âœ… è§£æ±ºï¼šæ¯å€‹å…¬å¼å®šç¾© inputs/outputs                                       â”‚
â”‚          Step Executor è‡ªå‹•å‚³éä¸­é–“çµæœ                                     â”‚
â”‚                                                                             â”‚
â”‚  âŒ å•é¡Œ 3ï¼šã€Œåƒæ•¸ä¸å¤ æ€éº¼è¾¦ï¼Ÿã€                                            â”‚
â”‚  âœ… è§£æ±ºï¼šcheck_completeness() é å…ˆæª¢æŸ¥                                     â”‚
â”‚          Interactive Clarifier ç”¢ç”Ÿæœ‰æ„ç¾©çš„å•é¡Œ                             â”‚
â”‚                                                                             â”‚
â”‚  âŒ å•é¡Œ 4ï¼šã€Œæœ‰å¤šç¨®æ¨å°æ–¹æ³•æ€éº¼é¸ï¼Ÿã€                                      â”‚
â”‚  âœ… è§£æ±ºï¼šDerivation Templates æä¾›æ¨™æº–æµç¨‹                                 â”‚
â”‚          Agent å¯ä»¥è©¢å•ç”¨æˆ¶åå¥½                                             â”‚
â”‚                                                                             â”‚
â”‚  âŒ å•é¡Œ 5ï¼šã€Œæ¨å°éç¨‹å°ä¸å°ï¼Ÿã€                                            â”‚
â”‚  âœ… è§£æ±ºï¼šæ¯æ­¥éƒ½ç”± SymPy ç²¾ç¢ºåŸ·è¡Œ                                           â”‚
â”‚          Result Assembler æä¾›å®Œæ•´æ¨å°éˆ                                    â”‚
â”‚          å¯é€²è¡Œç¶­åº¦åˆ†æå’Œåå‘é©—è­‰                                           â”‚
â”‚                                                                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## 3.4 ğŸ†• æ¨å° DSLï¼ˆDerivation Domain-Specific Languageï¼‰

### ç‚ºä»€éº¼éœ€è¦ Pseudo Code é¢¨æ ¼çš„æ¨å°èªè¨€ï¼Ÿ

```
å‚³çµ±æ–¹å¼çš„å•é¡Œï¼š
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
  ã€Œå° RC ä½é€šæ¿¾æ³¢å™¨ï¼Œæ±‚æˆªæ­¢é »ç‡å’Œç›¸ä½å»¶é²ã€
  
  é€™å¥è©±éš±å«äº†å¤ªå¤šæ­¥é©Ÿï¼š
  1. å»ºç«‹é›»è·¯æ¨¡å‹ï¼ˆå“ªç¨®æ‹“æ’²ï¼Ÿï¼‰
  2. é¸æ“‡åˆ†ææ–¹æ³•ï¼ˆæ™‚åŸŸï¼Ÿé »åŸŸï¼Ÿï¼‰
  3. æ¨å°å‚³éå‡½æ•¸
  4. æ±‚å‡ºæˆªæ­¢é »ç‡
  5. è¨ˆç®—ç›¸ä½éŸ¿æ‡‰
  6. å¾ç›¸ä½éŸ¿æ‡‰å°å‡ºç¾¤å»¶é²
  
  â†’ æ¯ä¸€æ­¥éƒ½å¯èƒ½æœ‰å¤šç¨®åšæ³•ï¼ŒLLM ç›´æ¥ç”Ÿæˆç­”æ¡ˆå®¹æ˜“å‡ºéŒ¯
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

DSL çš„è§£æ±ºæ–¹æ¡ˆï¼š
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
  ç”¨çµæ§‹åŒ–çš„ã€Œæ¨å°è…³æœ¬ã€æ˜ç¢ºæè¿°æ¯ä¸€æ­¥ï¼Œ
  æ¯æ­¥éƒ½å¯ä»¥è¢«ç¬¦è™Ÿå¼•æ“é©—è­‰åŸ·è¡Œ
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
```

### æ¨å° DSL èªæ³•è¨­è¨ˆ

```yaml
# derivation_script.yaml - æ¨å°è…³æœ¬ç¯„ä¾‹

derivation:
  name: "RCä½é€šæ¿¾æ³¢å™¨é »ç‡éŸ¿æ‡‰åˆ†æ"
  domain: "circuit_analysis"
  
  # å®£å‘Šç¬¦è™Ÿ
  symbols:
    - {name: R, type: positive_real, unit: ohm, description: "é›»é˜»"}
    - {name: C, type: positive_real, unit: farad, description: "é›»å®¹"}
    - {name: s, type: complex, description: "Laplace è®Šæ•¸"}
    - {name: omega, type: positive_real, unit: rad/s, description: "è§’é »ç‡"}
    - {name: f, type: positive_real, unit: Hz, description: "é »ç‡"}
  
  # æ¨å°æ­¥é©Ÿ
  steps:
    - id: step_1
      action: define_circuit
      description: "å®šç¾© RC ä½é€šæ¿¾æ³¢å™¨é›»è·¯"
      circuit:
        topology: series_RC
        input: V_in
        output: V_out  # è·¨é›»å®¹çš„é›»å£“
      
    - id: step_2
      action: derive_transfer_function
      description: "æ¨å°å‚³éå‡½æ•¸ H(s) = V_out/V_in"
      method: voltage_divider
      formula: |
        Z_C = 1/(s*C)
        Z_R = R
        H(s) = Z_C / (Z_R + Z_C)
      result: H_s
      
    - id: step_3
      action: simplify
      description: "åŒ–ç°¡å‚³éå‡½æ•¸"
      input: H_s
      expected_form: "1 / (1 + s*R*C)"
      result: H_s_simplified
      
    - id: step_4
      action: substitute
      description: "ä»£å…¥ s = jÏ‰ å¾—åˆ°é »ç‡éŸ¿æ‡‰"
      input: H_s_simplified
      substitution: {s: I*omega}  # I æ˜¯è™›æ•¸å–®ä½
      result: H_jw
      
    - id: step_5
      action: solve_for
      description: "æ±‚æˆªæ­¢é »ç‡ï¼ˆ|H| = 1/âˆš2 æ™‚ï¼‰"
      equation: "Abs(H_jw) = 1/sqrt(2)"
      solve_for: omega
      result: omega_c
      verification: "omega_c = 1/(R*C)"
      
    - id: step_6
      action: derive_phase
      description: "è¨ˆç®—ç›¸ä½éŸ¿æ‡‰"
      input: H_jw
      operation: arg  # å–å¹…è§’
      result: phi_omega
      expected: "-atan(omega * R * C)"
      
    - id: step_7
      action: derive_group_delay
      description: "è¨ˆç®—ç¾¤å»¶é²ï¼ˆç›¸ä½å°é »ç‡çš„å°æ•¸ï¼‰"
      formula: "tau_g = -d(phi_omega)/d(omega)"
      input: phi_omega
      result: group_delay
      
  # æœ€çµ‚è¼¸å‡º
  outputs:
    - {name: H_s, description: "å‚³éå‡½æ•¸", latex: "H(s) = \\frac{1}{1+sRC}"}
    - {name: omega_c, description: "æˆªæ­¢è§’é »ç‡", latex: "\\omega_c = \\frac{1}{RC}"}
    - {name: f_c, description: "æˆªæ­¢é »ç‡", latex: "f_c = \\frac{1}{2\\pi RC}"}
    - {name: phi_omega, description: "ç›¸ä½éŸ¿æ‡‰", latex: "\\phi(\\omega) = -\\arctan(\\omega RC)"}
    - {name: group_delay, description: "ç¾¤å»¶é²", latex: "\\tau_g = \\frac{RC}{1+(\\omega RC)^2}"}
```

### DSL åŸ·è¡Œå¼•æ“

```python
class DerivationDSLEngine:
    """æ¨å° DSL è§£é‡‹å™¨"""
    
    def __init__(self):
        self.symbol_table = {}  # ç¬¦è™Ÿè¡¨
        self.results = {}       # ä¸­é–“çµæœ
        self.trace = []         # åŸ·è¡Œè¿½è¹¤
    
    def execute_script(self, script: dict) -> DerivationResult:
        """åŸ·è¡Œæ¨å°è…³æœ¬"""
        
        # 1. åˆå§‹åŒ–ç¬¦è™Ÿ
        self._init_symbols(script["symbols"])
        
        # 2. é€æ­¥åŸ·è¡Œ
        for step in script["steps"]:
            result = self._execute_step(step)
            self.results[step["result"]] = result
            self.trace.append({
                "step_id": step["id"],
                "description": step["description"],
                "input": step.get("input"),
                "result": result,
                "latex": sympy.latex(result)
            })
        
        # 3. çµ„è£è¼¸å‡º
        return DerivationResult(
            outputs=self._format_outputs(script["outputs"]),
            trace=self.trace,
            verification=self._verify_results(script)
        )
    
    def _execute_step(self, step: dict):
        """åŸ·è¡Œå–®ä¸€æ¨å°æ­¥é©Ÿ"""
        action = step["action"]
        
        if action == "derive_transfer_function":
            return self._derive_transfer_function(step)
        elif action == "simplify":
            expr = self.results[step["input"]]
            return sympy.simplify(expr)
        elif action == "substitute":
            expr = self.results[step["input"]]
            subs = {sympy.Symbol(k): self._parse_expr(v) 
                    for k, v in step["substitution"].items()}
            return expr.subs(subs)
        elif action == "solve_for":
            return self._solve_equation(step)
        elif action == "derive_phase":
            expr = self.results[step["input"]]
            return sympy.arg(expr)
        elif action == "derive_group_delay":
            phi = self.results[step["input"]]
            omega = self.symbol_table["omega"]
            return -sympy.diff(phi, omega)
        # ... æ›´å¤š action é¡å‹
```

---

## 3.5 ğŸ†• ç³»çµ±ç´šæ¨å°ç¯„ä¾‹ï¼šAudio Amplifier é›»è·¯åˆ†æ

### å•é¡Œæè¿°

```
å ´æ™¯ï¼šä¿®æ”¹ Audio Amplifier é›»è·¯
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
åŸå§‹é›»è·¯ï¼š
  â€¢ å–®ç´šè¨Šè™Ÿæ”¾å¤§ (Voltage Gain)
  â€¢ å°æ¿¾æ³¢é›»å®¹ C1
  â€¢ æœ‰è² å›æˆ (Negative Feedback)

ä¿®æ”¹å¾Œï¼š
  â€¢ åŠ å…¥åŠŸç‡æ”¾å¤§ç´š (Power Stage)
  â€¢ æ›´å¤§çš„æ¿¾æ³¢é›»å®¹ C2 >> C1
  â€¢ ç§»é™¤è² å›æˆ (Open Loop)

å•é¡Œï¼š
  1. é€™äº›ä¿®æ”¹å¦‚ä½•å½±éŸ¿é »ç‡éŸ¿æ‡‰ï¼Ÿ
  2. å°éŸ³è¨Šå»¶é²æœ‰ä»€éº¼å½±éŸ¿ï¼Ÿ
  3. æœƒç”¢ç”Ÿä»€éº¼å¤±çœŸï¼Ÿ
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
```

### æ¨å°è…³æœ¬ï¼šéŸ³é »æ”¾å¤§å™¨é »ç‡éŸ¿æ‡‰åˆ†æ

```yaml
derivation:
  name: "éŸ³é »æ”¾å¤§å™¨ä¿®æ”¹å¾Œçš„é »ç‡éŸ¿æ‡‰åˆ†æ"
  domain: "circuit_analysis"
  
  # === ç¬¦è™Ÿå®šç¾© ===
  symbols:
    # åŸå§‹é›»è·¯åƒæ•¸
    - {name: R_in, type: positive_real, unit: ohm, description: "è¼¸å…¥é›»é˜»"}
    - {name: R_load, type: positive_real, unit: ohm, description: "è² è¼‰é›»é˜»"}
    - {name: C1, type: positive_real, unit: farad, description: "åŸæ¿¾æ³¢é›»å®¹"}
    - {name: C2, type: positive_real, unit: farad, description: "æ–°æ¿¾æ³¢é›»å®¹ (C2 >> C1)"}
    - {name: A_ol, type: positive_real, description: "é–‹ç’°å¢ç›Š"}
    - {name: beta, type: positive_real, description: "å›æˆä¿‚æ•¸"}
    
    # é »ç‡è®Šæ•¸
    - {name: s, type: complex, description: "Laplace è®Šæ•¸"}
    - {name: f, type: positive_real, unit: Hz, description: "é »ç‡"}
    - {name: omega, type: positive_real, unit: rad/s, description: "è§’é »ç‡"}
  
  # === ç³»çµ±å»ºæ¨¡ ===
  systems:
    original_amp:
      description: "åŸå§‹æ”¾å¤§å™¨ï¼ˆæœ‰è² å›æˆï¼‰"
      blocks:
        - {type: gain, value: A_ol, name: "é–‹ç’°å¢ç›Š"}
        - {type: lowpass_rc, R: R_in, C: C1, name: "è¼¸å…¥æ¿¾æ³¢"}
        - {type: feedback, beta: beta, name: "è² å›æˆ"}
      topology: "input â†’ lowpass_rc â†’ gain â†’ output, output â†’ feedback â†’ input"
      
    modified_amp:
      description: "ä¿®æ”¹å¾Œæ”¾å¤§å™¨ï¼ˆç„¡è² å›æˆ + å¤§é›»å®¹ï¼‰"
      blocks:
        - {type: gain, value: A_ol, name: "é–‹ç’°å¢ç›Š"}
        - {type: lowpass_rc, R: R_in, C: C2, name: "è¼¸å…¥æ¿¾æ³¢ï¼ˆå¤§é›»å®¹ï¼‰"}
        - {type: power_stage, gain: A_p, name: "åŠŸç‡æ”¾å¤§ç´š"}
      topology: "input â†’ lowpass_rc â†’ gain â†’ power_stage â†’ output"
  
  # === æ¨å°æ­¥é©Ÿ ===
  steps:
    # --- Part 1: åŸå§‹é›»è·¯åˆ†æ ---
    - id: orig_1
      action: derive_transfer_function
      system: original_amp
      description: "åŸå§‹é›»è·¯å‚³éå‡½æ•¸ï¼ˆå«è² å›æˆï¼‰"
      method: feedback_formula  # H = A / (1 + A*beta)
      result: H_original
      
    - id: orig_2
      action: find_cutoff_frequency
      input: H_original
      description: "åŸå§‹é›»è·¯æˆªæ­¢é »ç‡"
      result: f_c_original
      expected: "f_c_original = (1 + A_ol*beta) / (2*pi*R_in*C1)"
      note: "è² å›æˆæ“´å±•äº†é »å¯¬ï¼"
      
    - id: orig_3
      action: derive_phase
      input: H_original
      description: "åŸå§‹é›»è·¯ç›¸ä½éŸ¿æ‡‰"
      result: phi_original
      
    # --- Part 2: ä¿®æ”¹å¾Œé›»è·¯åˆ†æ ---
    - id: mod_1
      action: derive_transfer_function
      system: modified_amp
      description: "ä¿®æ”¹å¾Œå‚³éå‡½æ•¸ï¼ˆç„¡å›æˆï¼‰"
      method: cascade  # H = H1 * H2 * H3
      result: H_modified
      
    - id: mod_2
      action: find_cutoff_frequency
      input: H_modified
      description: "ä¿®æ”¹å¾Œæˆªæ­¢é »ç‡"
      result: f_c_modified
      expected: "f_c_modified = 1 / (2*pi*R_in*C2)"
      note: "C2 >> C1ï¼Œæˆªæ­¢é »ç‡å¤§å¹…ä¸‹é™"
      
    - id: mod_3
      action: derive_phase
      input: H_modified
      description: "ä¿®æ”¹å¾Œç›¸ä½éŸ¿æ‡‰"
      result: phi_modified
      
    # --- Part 3: æ¯”è¼ƒåˆ†æ ---
    - id: compare_1
      action: compute_ratio
      description: "æˆªæ­¢é »ç‡è®ŠåŒ–æ¯”ä¾‹"
      formula: "f_c_original / f_c_modified"
      result: freq_ratio
      interpretation: |
        è‹¥ C2 = 10*C1 ä¸”ç§»é™¤è² å›æˆï¼š
        freq_ratio â‰ˆ (1 + A_ol*beta) * (C2/C1)
        å‡è¨­ A_ol*beta = 100, C2/C1 = 10
        â†’ æˆªæ­¢é »ç‡ä¸‹é™ç´„ 1000 å€ï¼
      
    - id: compare_2
      action: derive_group_delay
      inputs: [phi_original, phi_modified]
      description: "ç¾¤å»¶é²æ¯”è¼ƒ"
      result: [tau_g_original, tau_g_modified]
      
    - id: compare_3
      action: evaluate_at_frequency
      description: "åœ¨ 1kHzï¼ˆéŸ³é »ä¸­é »ï¼‰çš„å»¶é²"
      inputs: [tau_g_original, tau_g_modified]
      at: {f: 1000}  # 1 kHz
      result: [delay_original_1k, delay_modified_1k]
      
    # --- Part 4: å¯¦éš›å½±éŸ¿è©•ä¼° ---
    - id: impact_1
      action: analyze_audio_impact
      description: "å°éŸ³é »çš„å¯¦éš›å½±éŸ¿"
      analysis:
        frequency_response:
          - "ä½é »å¢å¼·ï¼šå¤§é›»å®¹é™ä½ä½é »æˆªæ­¢é»"
          - "é«˜é »è¡°æ¸›ï¼šæˆªæ­¢é »ç‡ä¸‹é™å°è‡´é«˜é »æ»¾é™"
        phase_distortion:
          - "ç›¸ä½å¤±çœŸå¢åŠ ï¼šç„¡è² å›æˆæ™‚ç›¸ä½æ›´éç·šæ€§"
          - "ç¾¤å»¶é²ä¸å‡å‹»ï¼šä¸åŒé »ç‡å»¶é²ä¸åŒ"
        amplitude:
          - "å¢ç›Šå¢åŠ ï¼šç§»é™¤è² å›æˆå¾Œå¢ç›Šå¾ A/(1+AÎ²) è®Šç‚º A"
          - "å¯èƒ½éè¼‰ï¼šéœ€è¦é™ä½è¼¸å…¥æˆ–åŠ è¡°æ¸›"
      
  # === æ•¸å€¼ç¯„ä¾‹ ===
  numerical_example:
    parameters:
      R_in: 10e3      # 10 kÎ©
      C1: 100e-12     # 100 pF
      C2: 1e-6        # 1 ÂµF (å¤§ 10000 å€)
      A_ol: 1000      # é–‹ç’°å¢ç›Š 60 dB
      beta: 0.1       # å›æˆä¿‚æ•¸
      A_p: 10         # åŠŸç‡ç´šå¢ç›Š
      
    results:
      original:
        closed_loop_gain: "A_ol / (1 + A_ol*beta) = 1000/101 â‰ˆ 9.9"
        bandwidth: "(1 + A_ol*beta) / (2Ï€*R_in*C1) â‰ˆ 161 kHz"
        delay_at_1k: "< 1 Âµs"
        
      modified:
        total_gain: "A_ol * A_p = 10000 (80 dB)"
        bandwidth: "1 / (2Ï€*R_in*C2) â‰ˆ 16 Hz"  # æ¥µçª„ï¼
        delay_at_1k: "~100 Âµs - å–æ±ºæ–¼æ¥µé»ä½ç½®"
        
    warnings:
      - "âš ï¸ æˆªæ­¢é »ç‡ 16 Hz å¤ªä½ï¼Œæœƒåš´é‡è¡°æ¸›éŸ³é »"
      - "âš ï¸ é–‹ç’°é‹ä½œå¢ç›Šéé«˜ï¼Œæ˜“é£½å’Œå¤±çœŸ"
      - "âš ï¸ ç›¸ä½éŸ¿æ‡‰éç·šæ€§å¢åŠ "
      
    recommendations:
      - "æ¸›å° C2 æˆ–å¢åŠ ä¸¦è¯é›»é˜»ä»¥æé«˜æˆªæ­¢é »ç‡"
      - "åŠ å…¥å±€éƒ¨è² å›æˆç©©å®šå¢ç›Š"
      - "è€ƒæ…®å¤šæ¥µé»è£œå„Ÿä»¥å¹³å¦åŒ–ç¾¤å»¶é²"

  # === è¼¸å‡º ===
  outputs:
    - name: frequency_response_comparison
      description: "é »ç‡éŸ¿æ‡‰å°æ¯”ï¼ˆBode åœ–æ•¸æ“šï¼‰"
      format: plot_data
      
    - name: phase_response_comparison
      description: "ç›¸ä½éŸ¿æ‡‰å°æ¯”"
      format: plot_data
      
    - name: group_delay_comparison
      description: "ç¾¤å»¶é²å°æ¯”"
      format: plot_data
      
    - name: summary_table
      description: "åƒæ•¸å°æ¯”è¡¨"
      columns: [Parameter, Original, Modified, Change]
```

### DSL åŸ·è¡Œçµæœç¯„ä¾‹

ç•¶ Agent è¦æ±‚åˆ†æé€™å€‹é›»è·¯ä¿®æ”¹æ™‚ï¼ŒMCP Server è¿”å›ï¼š

```json
{
  "analysis_type": "audio_amplifier_modification",
  
  "transfer_functions": {
    "original": {
      "latex": "H_{orig}(s) = \\frac{A_{ol}}{(1 + A_{ol}\\beta)(1 + sR_{in}C_1)}",
      "sympy": "A_ol / ((1 + A_ol*beta) * (1 + s*R_in*C1))"
    },
    "modified": {
      "latex": "H_{mod}(s) = \\frac{A_{ol} \\cdot A_p}{1 + sR_{in}C_2}",
      "sympy": "A_ol * A_p / (1 + s*R_in*C2)"
    }
  },
  
  "cutoff_frequencies": {
    "original": {
      "formula": "f_c = (1 + A_ol*beta) / (2*pi*R_in*C1)",
      "numerical": "161 kHz",
      "comment": "è² å›æˆæ“´å±•é »å¯¬"
    },
    "modified": {
      "formula": "f_c = 1 / (2*pi*R_in*C2)",
      "numerical": "16 Hz",
      "comment": "âš ï¸ é ä½æ–¼éŸ³é »ç¯„åœä¸‹é™ 20 Hz"
    }
  },
  
  "group_delay": {
    "original": {
      "formula_latex": "\\tau_g = \\frac{R_{in}C_1}{1 + (\\omega R_{in}C_1)^2}",
      "at_1kHz": "< 1 Âµs",
      "variation_20Hz_20kHz": "negligible"
    },
    "modified": {
      "formula_latex": "\\tau_g = \\frac{R_{in}C_2}{1 + (\\omega R_{in}C_2)^2}",
      "at_1kHz": "~100 Âµs",
      "variation_20Hz_20kHz": "significant (é »ç‡ä¾è³´)"
    }
  },
  
  "audio_impact_assessment": {
    "frequency_response": {
      "severity": "critical",
      "issues": [
        "æˆªæ­¢é »ç‡ 16 Hz æœƒè¡°æ¸›çµ•å¤§éƒ¨åˆ†éŸ³é »å…§å®¹",
        "1 kHz è™•å·²æœ‰ -36 dB è¡°æ¸›",
        "20 kHz è™•å¹¾ä¹å®Œå…¨è¡°æ¸›"
      ]
    },
    "phase_distortion": {
      "severity": "moderate", 
      "issues": [
        "ä¸åŒé »ç‡çš„å»¶é²å·®ç•°æœƒé€ æˆæ™‚åŸŸå¤±çœŸ",
        "å½±éŸ¿ç¬æ…‹éŸ¿æ‡‰ï¼ˆæ‰“æ“Šæ¨‚å™¨ã€é½’éŸ³ï¼‰"
      ]
    },
    "gain_stability": {
      "severity": "high",
      "issues": [
        "é–‹ç’°å¢ç›Š 80 dB æ¥µæ˜“é£½å’Œ",
        "å°è¼¸å…¥è®ŠåŒ–æ¥µåº¦æ•æ„Ÿ"
      ]
    }
  },
  
  "recommendations": [
    {
      "priority": 1,
      "action": "æ¸›å°æ¿¾æ³¢é›»å®¹",
      "suggestion": "C2 = 1 nF â†’ f_c â‰ˆ 16 kHz",
      "tradeoff": "æ¸›å°‘ä½é »æ¿¾æ³¢æ•ˆæœ"
    },
    {
      "priority": 2,
      "action": "æ¢å¾©éƒ¨åˆ†è² å›æˆ",
      "suggestion": "åŠ å…¥å±€éƒ¨å›æˆ beta_local = 0.01",
      "benefit": "ç©©å®šå¢ç›Šã€æ“´å±•é »å¯¬"
    },
    {
      "priority": 3,
      "action": "å¤šç´šè¨­è¨ˆ",
      "suggestion": "å°‡å¤§é›»å®¹æ‹†åˆ†ç‚ºå¤šå€‹å°é›»å®¹ç´šè¯",
      "benefit": "æ›´å¹³å¦çš„ç¾¤å»¶é²"
    }
  ],
  
  "derivation_trace": [
    {"step": 1, "action": "å»ºç«‹åŸå§‹é›»è·¯æ¨¡å‹", "status": "âœ“"},
    {"step": 2, "action": "æ¨å°é–‰ç’°å‚³éå‡½æ•¸", "status": "âœ“"},
    {"step": 3, "action": "æ±‚æˆªæ­¢é »ç‡ï¼ˆé–‰ç’°ï¼‰", "status": "âœ“"},
    {"step": 4, "action": "å»ºç«‹ä¿®æ”¹å¾Œé›»è·¯æ¨¡å‹", "status": "âœ“"},
    {"step": 5, "action": "æ¨å°é–‹ç’°å‚³éå‡½æ•¸", "status": "âœ“"},
    {"step": 6, "action": "æ±‚æˆªæ­¢é »ç‡ï¼ˆé–‹ç’°ï¼‰", "status": "âœ“"},
    {"step": 7, "action": "è¨ˆç®—ç¾¤å»¶é²", "status": "âœ“"},
    {"step": 8, "action": "è©•ä¼°éŸ³é »å½±éŸ¿", "status": "âœ“"}
  ]
}
```

### é€™å€‹ç¯„ä¾‹å±•ç¤ºçš„ DSL å„ªå‹¢

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                     Pseudo Code DSL çš„åƒ¹å€¼                                  â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                             â”‚
â”‚  1ï¸âƒ£ æ˜ç¢ºçš„æ¨å°æ­¥é©Ÿ                                                          â”‚
â”‚     â€¢ æ¯ä¸€æ­¥éƒ½æœ‰æ¸…æ™°çš„ action å®šç¾©                                          â”‚
â”‚     â€¢ è¼¸å…¥è¼¸å‡ºé—œä¿‚æ˜ç¢º                                                      â”‚
â”‚     â€¢ å¯ä»¥é©—è­‰æ¯æ­¥çš„æ­£ç¢ºæ€§                                                  â”‚
â”‚                                                                             â”‚
â”‚  2ï¸âƒ£ ç³»çµ±ç´šå»ºæ¨¡                                                              â”‚
â”‚     â€¢ å¯ä»¥æè¿°é›»è·¯æ‹“æ’²ï¼ˆblocks + topologyï¼‰                                 â”‚
â”‚     â€¢ æ”¯æ´å¤šç³»çµ±æ¯”è¼ƒï¼ˆoriginal vs modifiedï¼‰                                â”‚
â”‚     â€¢ æ”¯æ´ç´šè¯ã€å›æˆç­‰è¤‡é›œçµæ§‹                                              â”‚
â”‚                                                                             â”‚
â”‚  3ï¸âƒ£ é ˜åŸŸçŸ¥è­˜åµŒå…¥                                                            â”‚
â”‚     â€¢ å…§å»º lowpass_rc, feedback ç­‰é›»è·¯åŸèª                                  â”‚
â”‚     â€¢ è‡ªå‹•å¥—ç”¨æ­£ç¢ºçš„å…¬å¼ï¼ˆå¦‚é–‰ç’°å¢ç›Šå…¬å¼ï¼‰                                  â”‚
â”‚     â€¢ æä¾›ç‰©ç†ç›´è¦ºçš„è§£é‡‹                                                    â”‚
â”‚                                                                             â”‚
â”‚  4ï¸âƒ£ å¯è¿½è¹¤å¯é‡ç¾                                                            â”‚
â”‚     â€¢ derivation_trace è¨˜éŒ„æ¯æ­¥                                             â”‚
â”‚     â€¢ å¯ä»¥é‡æ–°åŸ·è¡Œå¾—åˆ°ç›¸åŒçµæœ                                              â”‚
â”‚     â€¢ å¯ä»¥ä¿®æ”¹åƒæ•¸é‡æ–°è¨ˆç®—                                                  â”‚
â”‚                                                                             â”‚
â”‚  5ï¸âƒ£ Agent å‹å–„                                                              â”‚
â”‚     â€¢ çµæ§‹åŒ–è¼¸å…¥è®“ LLM æ›´å®¹æ˜“ç”Ÿæˆæ­£ç¢ºè…³æœ¬                                   â”‚
â”‚     â€¢ è±å¯Œçš„è¼¸å‡ºè®“ Agent èƒ½çµ¦ç”¨æˆ¶å®Œæ•´è§£é‡‹                                   â”‚
â”‚     â€¢ éŒ¯èª¤è¨Šæ¯æ˜ç¢ºï¼Œä¾¿æ–¼ Agent ä¿®æ­£                                         â”‚
â”‚                                                                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## 4. æ ¸å¿ƒçµ„ä»¶

### 4.1 Parser Layerï¼ˆè§£æå±¤ï¼‰

è² è²¬å°‡å„ç¨®æ ¼å¼çš„è¼¸å…¥è½‰æ›ç‚ºçµ±ä¸€çš„å…§éƒ¨è¡¨ç¤ºã€‚

#### 4.1.1 æ”¯æ´çš„è¼¸å…¥æ ¼å¼

| æ ¼å¼ | ç¯„ä¾‹ | ç”¨é€” |
|------|------|------|
| **LaTeX** | `\frac{d}{dx}(x^3)` | å­¸è¡“æ–‡æª”ã€è«–æ–‡ |
| **ASCII Math** | `d/dx (x^3)` | å¿«é€Ÿè¼¸å…¥ |
| **ç¨‹å¼é¢¨æ ¼** | `diff(x**3, x)` | ç¨‹å¼è¨­è¨ˆå¸« |
| **è‡ªç„¶èªè¨€** | `å° xÂ³ å¾®åˆ†` | ä¸€èˆ¬ç”¨æˆ¶ |

#### 4.1.2 å…§éƒ¨è¡¨ç¤º (IR)

```python
# çµ±ä¸€çš„å…§éƒ¨è¡¨ç¤ºæ ¼å¼
{
    "operation": "diff",           # æ“ä½œé¡å‹
    "expression": "x**3 + 2*x",    # SymPy æ ¼å¼è¡¨é”å¼
    "variable": "x",               # æ“ä½œè®Šæ•¸
    "options": {                   # é¡å¤–é¸é …
        "order": 1,                # å¾®åˆ†éšæ•¸
        "evaluate": True           # æ˜¯å¦æ±‚å€¼
    },
    "metadata": {
        "original_input": "\\frac{d}{dx}(x^3 + 2x)",
        "input_format": "latex"
    }
}
```

### 4.2 Engine Layerï¼ˆå¼•æ“å±¤ï¼‰

åŸ·è¡Œå¯¦éš›çš„ç¬¦è™Ÿé‹ç®—ã€‚

#### 4.2.1 SymPy Engineï¼ˆæ ¸å¿ƒï¼‰

```python
class SymPyEngine:
    """åŸºæ–¼ SymPy çš„ç¬¦è™Ÿè¨ˆç®—å¼•æ“"""
    
    supported_operations = [
        # å¾®ç©åˆ†
        "diff",        # å¾®åˆ†
        "integrate",   # ç©åˆ†
        "limit",       # æ¥µé™
        "series",      # ç´šæ•¸å±•é–‹
        
        # ä»£æ•¸
        "simplify",    # ç°¡åŒ–
        "expand",      # å±•é–‹
        "factor",      # å› å¼åˆ†è§£
        "solve",       # è§£æ–¹ç¨‹
        
        # ç·šæ€§ä»£æ•¸
        "matrix_ops",  # çŸ©é™£é‹ç®—
        "eigenvalue",  # ç‰¹å¾µå€¼
        
        # å…¶ä»–
        "substitute",  # ä»£å…¥
        "evaluate",    # æ±‚å€¼
    ]
```

#### 4.2.2 Physics Moduleï¼ˆç‰©ç†æ¨¡çµ„ï¼‰

```python
class PhysicsModule:
    """ç‰©ç†å…¬å¼èˆ‡æ¨å°"""
    
    domains = {
        "mechanics": [
            "kinematic_equations",  # é‹å‹•å­¸æ–¹ç¨‹
            "newton_laws",          # ç‰›é “å®šå¾‹
            "work_energy",          # åŠŸèˆ‡èƒ½
            "momentum",             # å‹•é‡
        ],
        "thermodynamics": [
            "ideal_gas_law",        # ç†æƒ³æ°£é«”å®šå¾‹
            "first_law",            # ç†±åŠ›å­¸ç¬¬ä¸€å®šå¾‹
            "entropy",              # ç†µ
            "carnot_cycle",         # å¡è«¾å¾ªç’°
        ],
        "electromagnetism": [
            "coulomb_law",          # åº«å€«å®šå¾‹
            "ohm_law",              # æ­å§†å®šå¾‹
            "maxwell_equations",    # é¦¬å…‹å£«å¨æ–¹ç¨‹
        ],
    }
```

#### 4.2.3 Chemistry Moduleï¼ˆåŒ–å­¸æ¨¡çµ„ï¼‰

```python
class ChemistryModule:
    """åŒ–å­¸è¨ˆç®—"""
    
    functions = [
        "balance_equation",     # é…å¹³åŒ–å­¸æ–¹ç¨‹å¼
        "molar_mass",           # åˆ†å­é‡è¨ˆç®—
        "stoichiometry",        # åŒ–å­¸è¨ˆé‡
        "equilibrium",          # å¹³è¡¡å¸¸æ•¸
        "ph_calculation",       # pH è¨ˆç®—
    ]
```

#### 4.2.4 Algorithm Moduleï¼ˆæ¼”ç®—æ³•æ¨¡çµ„ï¼‰

```python
class AlgorithmModule:
    """æ¼”ç®—æ³•åˆ†æ"""
    
    functions = [
        "solve_recurrence",     # è§£éè¿´é—œä¿‚
        "master_theorem",       # ä¸»å®šç†åˆ†æ
        "big_o_analysis",       # è¤‡é›œåº¦åˆ†æ
        "amortized_analysis",   # æ”¤é‚„åˆ†æ
    ]
```

### 4.3 Knowledge Layerï¼ˆçŸ¥è­˜å±¤ï¼‰

å­˜å„²é ˜åŸŸçŸ¥è­˜å’Œè¦å‰‡ã€‚

```python
# ç‰©ç†å¸¸æ•¸
CONSTANTS = {
    "c": {"value": 299792458, "unit": "m/s", "name": "å…‰é€Ÿ"},
    "h": {"value": 6.62607015e-34, "unit": "JÂ·s", "name": "æ™®æœ—å…‹å¸¸æ•¸"},
    "k_B": {"value": 1.380649e-23, "unit": "J/K", "name": "æ³¢èŒ²æ›¼å¸¸æ•¸"},
    "R": {"value": 8.314462618, "unit": "J/(molÂ·K)", "name": "æ°£é«”å¸¸æ•¸"},
    "N_A": {"value": 6.02214076e23, "unit": "1/mol", "name": "äºä½›åŠ å¥å¸¸æ•¸"},
    # ...
}

# å…¬å¼æ¨¡æ¿
FORMULA_TEMPLATES = {
    "ideal_gas_law": {
        "formula": "P*V = n*R*T",
        "variables": ["P", "V", "n", "R", "T"],
        "description": "ç†æƒ³æ°£é«”ç‹€æ…‹æ–¹ç¨‹",
    },
    # ...
}
```

---

## 5. MCP å·¥å…·å®šç¾©

### 5.1 symbolic_calculate

**ç”¨é€”**: åŸ·è¡Œç¬¦è™Ÿæ•¸å­¸è¨ˆç®—

```json
{
    "name": "symbolic_calculate",
    "description": "åŸ·è¡Œç¬¦è™Ÿæ•¸å­¸è¨ˆç®—ï¼ŒåŒ…æ‹¬å¾®ç©åˆ†ã€ä»£æ•¸ã€æ–¹ç¨‹æ±‚è§£ç­‰ã€‚çµæœä¿è­‰æ•¸å­¸æ­£ç¢ºæ€§ã€‚",
    "inputSchema": {
        "type": "object",
        "properties": {
            "operation": {
                "type": "string",
                "enum": ["diff", "integrate", "limit", "series", "simplify", 
                         "expand", "factor", "solve", "substitute"],
                "description": "æ“ä½œé¡å‹"
            },
            "expression": {
                "type": "string",
                "description": "æ•¸å­¸è¡¨é”å¼ï¼ˆæ”¯æ´ LaTeXã€ASCII Mathã€ç¨‹å¼é¢¨æ ¼ï¼‰"
            },
            "variable": {
                "type": "string",
                "description": "æ“ä½œè®Šæ•¸ï¼ˆå¦‚ x, t, thetaï¼‰"
            },
            "options": {
                "type": "object",
                "description": "é¡å¤–é¸é …ï¼Œå¦‚ç©åˆ†ä¸Šä¸‹é™ã€å¾®åˆ†éšæ•¸ç­‰"
            }
        },
        "required": ["operation", "expression"]
    }
}
```

**å›å‚³æ ¼å¼**:

```json
{
    "success": true,
    "input": {
        "operation": "integrate",
        "expression": "x^2",
        "variable": "x"
    },
    "result": {
        "symbolic": "x**3/3",
        "latex": "\\frac{x^3}{3}",
        "pretty": "xÂ³/3"
    },
    "steps": [
        {"step": 1, "description": "å¥—ç”¨å†ªæ¬¡è¦å‰‡", "result": "âˆ«x^n dx = x^(n+1)/(n+1)"},
        {"step": 2, "description": "ä»£å…¥ n=2", "result": "x^3/3"},
        {"step": 3, "description": "åŠ ä¸Šç©åˆ†å¸¸æ•¸", "result": "x^3/3 + C"}
    ],
    "verification": {
        "method": "differentiation",
        "check": "d/dx(xÂ³/3) = xÂ²",
        "passed": true
    }
}
```

### 5.2 physics_formula

**ç”¨é€”**: ç‰©ç†å…¬å¼è¨ˆç®—èˆ‡æ¨å°

```json
{
    "name": "physics_formula",
    "description": "ç‰©ç†å…¬å¼è¨ˆç®—èˆ‡æ¨å°ï¼Œæ”¯æ´åŠ›å­¸ã€ç†±åŠ›å­¸ã€é›»ç£å­¸ç­‰é ˜åŸŸã€‚",
    "inputSchema": {
        "type": "object",
        "properties": {
            "domain": {
                "type": "string",
                "enum": ["mechanics", "thermodynamics", "electromagnetism", 
                         "optics", "quantum", "relativity"],
                "description": "ç‰©ç†é ˜åŸŸ"
            },
            "formula": {
                "type": "string",
                "description": "å…¬å¼åç¨±æˆ–è¡¨é”å¼"
            },
            "known_values": {
                "type": "object",
                "description": "å·²çŸ¥é‡åŠå…¶å€¼ï¼ˆå«å–®ä½ï¼‰"
            },
            "solve_for": {
                "type": "string",
                "description": "è¦æ±‚è§£çš„è®Šæ•¸"
            },
            "show_derivation": {
                "type": "boolean",
                "default": true,
                "description": "æ˜¯å¦é¡¯ç¤ºæ¨å°éç¨‹"
            }
        },
        "required": ["domain", "formula"]
    }
}
```

### 5.3 verify_derivation

**ç”¨é€”**: é©—è­‰æ•¸å­¸/ç‰©ç†æ¨å°çš„æ­£ç¢ºæ€§

```json
{
    "name": "verify_derivation",
    "description": "é©—è­‰ä¸€ç³»åˆ—æ¨å°æ­¥é©Ÿæ˜¯å¦é‚è¼¯æ­£ç¢ºã€‚",
    "inputSchema": {
        "type": "object",
        "properties": {
            "steps": {
                "type": "array",
                "items": {
                    "type": "object",
                    "properties": {
                        "from": {"type": "string"},
                        "to": {"type": "string"},
                        "justification": {"type": "string"}
                    }
                },
                "description": "æ¨å°æ­¥é©Ÿåˆ—è¡¨"
            },
            "assumptions": {
                "type": "array",
                "items": {"type": "string"},
                "description": "å‰æå‡è¨­"
            }
        },
        "required": ["steps"]
    }
}
```

### 5.4 chemistry_calculate

**ç”¨é€”**: åŒ–å­¸è¨ˆç®—

```json
{
    "name": "chemistry_calculate",
    "description": "åŒ–å­¸ç›¸é—œè¨ˆç®—ï¼ŒåŒ…æ‹¬é…å¹³æ–¹ç¨‹å¼ã€è¨ˆé‡è¨ˆç®—ã€å¹³è¡¡å¸¸æ•¸ç­‰ã€‚",
    "inputSchema": {
        "type": "object",
        "properties": {
            "operation": {
                "type": "string",
                "enum": ["balance", "molar_mass", "stoichiometry", 
                         "equilibrium", "ph", "redox"],
                "description": "æ“ä½œé¡å‹"
            },
            "input": {
                "type": "string",
                "description": "åŒ–å­¸å¼æˆ–æ–¹ç¨‹å¼"
            },
            "conditions": {
                "type": "object",
                "description": "åæ‡‰æ¢ä»¶ï¼ˆæº«åº¦ã€æ¿ƒåº¦ç­‰ï¼‰"
            }
        },
        "required": ["operation", "input"]
    }
}
```

### 5.5 algorithm_analyze

**ç”¨é€”**: æ¼”ç®—æ³•è¤‡é›œåº¦åˆ†æ

```json
{
    "name": "algorithm_analyze",
    "description": "åˆ†ææ¼”ç®—æ³•çš„æ™‚é–“/ç©ºé–“è¤‡é›œåº¦ã€‚",
    "inputSchema": {
        "type": "object",
        "properties": {
            "analysis_type": {
                "type": "string",
                "enum": ["recurrence", "big_o", "amortized", "space"],
                "description": "åˆ†æé¡å‹"
            },
            "expression": {
                "type": "string",
                "description": "éè¿´é—œä¿‚å¼æˆ–è¤‡é›œåº¦è¡¨é”å¼"
            },
            "method": {
                "type": "string",
                "enum": ["master_theorem", "substitution", "recursion_tree", "iteration"],
                "description": "åˆ†ææ–¹æ³•"
            }
        },
        "required": ["analysis_type", "expression"]
    }
}
```

### 5.6 unit_convert

**ç”¨é€”**: å–®ä½æ›ç®—

```json
{
    "name": "unit_convert",
    "description": "ç‰©ç†é‡å–®ä½æ›ç®—ï¼Œæ”¯æ´åœ‹éš›å–®ä½åˆ¶å’Œå¸¸ç”¨å–®ä½ã€‚",
    "inputSchema": {
        "type": "object",
        "properties": {
            "value": {
                "type": "number",
                "description": "æ•¸å€¼"
            },
            "from_unit": {
                "type": "string",
                "description": "åŸå§‹å–®ä½"
            },
            "to_unit": {
                "type": "string",
                "description": "ç›®æ¨™å–®ä½"
            }
        },
        "required": ["value", "from_unit", "to_unit"]
    }
}
```

---

## 6. ä½¿ç”¨å ´æ™¯èˆ‡ç¯„ä¾‹

### 6.1 å¾®ç©åˆ†è¨ˆç®—

**ç”¨æˆ¶è«‹æ±‚**: ã€Œè¨ˆç®— âˆ«(xÂ² + 3x)dx ä¸¦é©—è­‰çµæœã€

**Agent å‘¼å«**:
```json
{
    "tool": "symbolic_calculate",
    "arguments": {
        "operation": "integrate",
        "expression": "x^2 + 3*x",
        "variable": "x"
    }
}
```

**MCP è¿”å›**:
```json
{
    "success": true,
    "result": {
        "symbolic": "x**3/3 + 3*x**2/2",
        "latex": "\\frac{x^3}{3} + \\frac{3x^2}{2} + C"
    },
    "steps": [
        {"step": 1, "action": "åˆ†è§£ç©åˆ†", "result": "âˆ«xÂ² dx + âˆ«3x dx"},
        {"step": 2, "action": "å° xÂ² ç©åˆ†", "result": "xÂ³/3"},
        {"step": 3, "action": "å° 3x ç©åˆ†", "result": "3xÂ²/2"},
        {"step": 4, "action": "åˆä½µä¸¦åŠ å¸¸æ•¸", "result": "xÂ³/3 + 3xÂ²/2 + C"}
    ],
    "verification": {
        "method": "differentiation",
        "result": "d/dx(xÂ³/3 + 3xÂ²/2 + C) = xÂ² + 3x âœ“",
        "passed": true
    }
}
```

### 6.2 ç†±åŠ›å­¸æ¨å°

**ç”¨æˆ¶è«‹æ±‚**: ã€Œç†æƒ³æ°£é«”ç­‰æº«è†¨è„¹åšçš„åŠŸæ˜¯å¤šå°‘ï¼Ÿå¾ V1 è†¨è„¹åˆ° V2ã€

**Agent å‘¼å«**:
```json
{
    "tool": "physics_formula",
    "arguments": {
        "domain": "thermodynamics",
        "formula": "isothermal_work",
        "known_values": {
            "process": "isothermal",
            "V1": "V1",
            "V2": "V2"
        },
        "solve_for": "W",
        "show_derivation": true
    }
}
```

**MCP è¿”å›**:
```json
{
    "success": true,
    "result": {
        "symbolic": "n*R*T*ln(V2/V1)",
        "latex": "W = nRT \\ln\\left(\\frac{V_2}{V_1}\\right)",
        "alternative": "W = P_1 V_1 \\ln\\left(\\frac{V_2}{V_1}\\right)"
    },
    "derivation": [
        {"step": 1, "description": "ç­‰æº«éç¨‹ï¼ŒPV = nRT = å¸¸æ•¸"},
        {"step": 2, "description": "P = nRT/V"},
        {"step": 3, "description": "åŠŸçš„å®šç¾©: W = âˆ«P dV"},
        {"step": 4, "description": "ä»£å…¥: W = âˆ«(nRT/V) dV"},
        {"step": 5, "description": "ç©åˆ†: W = nRT ln(V)|_{V1}^{V2}"},
        {"step": 6, "description": "çµæœ: W = nRT ln(V2/V1)"}
    ],
    "notes": [
        "V2 > V1 æ™‚ï¼ŒW > 0ï¼Œç³»çµ±å°å¤–åšåŠŸ",
        "å¯ç”¨ P1V1 ä»£æ›¿ nRTï¼ˆç­‰æº«æ¢ä»¶ä¸‹ç›¸ç­‰ï¼‰"
    ]
}
```

### 6.3 æ¼”ç®—æ³•è¤‡é›œåº¦åˆ†æ

**ç”¨æˆ¶è«‹æ±‚**: ã€Œåˆ†æ T(n) = 2T(n/2) + n çš„æ™‚é–“è¤‡é›œåº¦ã€

**Agent å‘¼å«**:
```json
{
    "tool": "algorithm_analyze",
    "arguments": {
        "analysis_type": "recurrence",
        "expression": "T(n) = 2*T(n/2) + n",
        "method": "master_theorem"
    }
}
```

**MCP è¿”å›**:
```json
{
    "success": true,
    "analysis": {
        "recurrence": "T(n) = 2T(n/2) + n",
        "standard_form": "T(n) = aT(n/b) + f(n)",
        "parameters": {
            "a": 2,
            "b": 2,
            "f(n)": "n"
        },
        "method": "Master Theorem",
        "calculation": {
            "log_b_a": "logâ‚‚(2) = 1",
            "n^log_b_a": "nÂ¹ = n",
            "compare": "f(n) = n = Î˜(n^log_b_a)"
        },
        "case": "Case 2: f(n) = Î˜(n^(log_b(a)))",
        "result": {
            "symbolic": "Theta(n * log(n))",
            "latex": "T(n) = \\Theta(n \\log n)"
        }
    },
    "examples": [
        "é€™æ˜¯ Merge Sort çš„æ™‚é–“è¤‡é›œåº¦",
        "n=1000 æ™‚ç´„éœ€ 10,000 æ¬¡æ“ä½œ"
    ]
}
```

### 6.4 åŒ–å­¸æ–¹ç¨‹å¼é…å¹³

**ç”¨æˆ¶è«‹æ±‚**: ã€Œé…å¹³ Fe + O2 â†’ Fe2O3ã€

**Agent å‘¼å«**:
```json
{
    "tool": "chemistry_calculate",
    "arguments": {
        "operation": "balance",
        "input": "Fe + O2 -> Fe2O3"
    }
}
```

**MCP è¿”å›**:
```json
{
    "success": true,
    "result": {
        "balanced": "4Fe + 3O2 â†’ 2Fe2O3",
        "coefficients": {"Fe": 4, "O2": 3, "Fe2O3": 2}
    },
    "verification": {
        "Fe": {"left": 4, "right": 4, "balanced": true},
        "O": {"left": 6, "right": 6, "balanced": true}
    }
}
```

### 6.5 ğŸŒŸ è¤‡é›œç‰©ç†å•é¡Œï¼šè»Šè¼›ç¢°æ’èˆ‡å®‰å…¨å¸¶å¼µåŠ›è¨ˆç®—

é€™å€‹ç¯„ä¾‹å±•ç¤ºäº†æœ¬å°ˆæ¡ˆçš„æ ¸å¿ƒåƒ¹å€¼ï¼š**å¼•å° Agent é€²è¡Œç²¾ç¢ºçš„ç¬¦è™Ÿæ¨å°ï¼Œä¸¦åœ¨åƒæ•¸ä¸è¶³æ™‚èˆ‡ç”¨æˆ¶äº’å‹•è¨è«–**ã€‚

#### å•é¡Œæè¿°

> è³ªé‡ m çš„äººåœ¨è³ªé‡ Mâ‚ çš„è»Šå­å…§ï¼Œä»¥é€Ÿåº¦ v å»ç¢°æ’åˆ°è³ªé‡ Mâ‚‚ çš„éœæ­¢è»Šè¼›ã€‚
> ç¢°æ’è§’åº¦ç‚º 45Â°ï¼Œå‡è¨­éå®Œç¾ç¢°æ’ï¼ˆæå¤± 30% å‹•èƒ½ï¼‰ã€‚
> å®‰å…¨å¸¶çš„å½ˆæ€§ä¿‚æ•¸ç‚º kï¼Œè«‹å•ï¼š
> 1. ç¢°æ’å¾Œè»Šè¼›çš„é€Ÿåº¦ï¼Ÿ
> 2. äººå—åˆ°çš„å®‰å…¨å¸¶å¼µåŠ› T ç‚ºå¤šå°‘ï¼Ÿ
> 3. ææ–™è€å—æ€§æ‡‰è©²ç‚ºä½•ï¼Ÿ

#### å·¥ä½œæµç¨‹åœ–

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                        è¤‡é›œç‰©ç†å•é¡Œè™•ç†æµç¨‹                                  â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                             â”‚
â”‚  ç”¨æˆ¶æå•ï¼ˆè‡ªç„¶èªè¨€ï¼‰                                                       â”‚
â”‚       â”‚                                                                     â”‚
â”‚       â–¼                                                                     â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚  â”‚ Step 1: Agent åˆ†æå•é¡Œï¼Œè­˜åˆ¥æ‰€éœ€ç‰©ç†æ¦‚å¿µ                            â”‚    â”‚
â”‚  â”‚                                                                     â”‚    â”‚
â”‚  â”‚  â€¢ å‹•é‡å®ˆæ†ï¼ˆè€ƒæ…®è§’åº¦ï¼‰                                             â”‚    â”‚
â”‚  â”‚  â€¢ èƒ½é‡å®ˆæ†ï¼ˆéå½ˆæ€§ç¢°æ’ï¼Œæå¤± 30%ï¼‰                                 â”‚    â”‚
â”‚  â”‚  â€¢ å½ˆç°§åŠ›å­¸ï¼ˆå®‰å…¨å¸¶å¼µåŠ›ï¼‰                                           â”‚    â”‚
â”‚  â”‚  â€¢ ç‰›é “ç¬¬äºŒå®šå¾‹ï¼ˆäººçš„æ¸›é€Ÿï¼‰                                         â”‚    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â”‚       â”‚                                                                     â”‚
â”‚       â–¼                                                                     â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚  â”‚ Step 2: Agent æª¢æŸ¥åƒæ•¸å®Œæ•´æ€§                                        â”‚    â”‚
â”‚  â”‚                                                                     â”‚    â”‚
â”‚  â”‚  âœ“ å·²çŸ¥: m, Mâ‚, Mâ‚‚, v, Î¸=45Â°, Î·=0.7 (ä¿ç•™70%èƒ½é‡), k               â”‚    â”‚
â”‚  â”‚  âœ— ç¼ºå°‘: ç¢°æ’æ™‚é–“ Î”t æˆ– å®‰å…¨å¸¶ä¼¸é•·é‡ x                              â”‚    â”‚
â”‚  â”‚                                                                     â”‚    â”‚
â”‚  â”‚  â†’ Agent å‘ç”¨æˆ¶è©¢å•ç¼ºå°‘çš„åƒæ•¸æˆ–åˆç†å‡è¨­                             â”‚    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â”‚       â”‚                                                                     â”‚
â”‚       â–¼                                                                     â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚  â”‚ Step 3: å‘¼å« MCP ç¬¦è™Ÿæ¨å°å·¥å…·ï¼ˆåˆ†æ­¥é€²è¡Œï¼‰                           â”‚    â”‚
â”‚  â”‚                                                                     â”‚    â”‚
â”‚  â”‚  Tool 1: physics_formula (ç¢°æ’å¾Œé€Ÿåº¦)                               â”‚    â”‚
â”‚  â”‚  Tool 2: physics_formula (äººçš„æ¸›é€Ÿåº¦)                               â”‚    â”‚
â”‚  â”‚  Tool 3: symbolic_calculate (å®‰å…¨å¸¶å¼µåŠ›)                            â”‚    â”‚
â”‚  â”‚  Tool 4: symbolic_calculate (ææ–™å®‰å…¨ä¿‚æ•¸)                          â”‚    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â”‚       â”‚                                                                     â”‚
â”‚       â–¼                                                                     â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚  â”‚ Step 4: æ•´åˆçµæœï¼Œæä¾›å®Œæ•´è§£ç­”                                      â”‚    â”‚
â”‚  â”‚                                                                     â”‚    â”‚
â”‚  â”‚  â€¢ ç¬¦è™Ÿè§£ï¼ˆå…¬å¼ï¼‰                                                   â”‚    â”‚
â”‚  â”‚  â€¢ æ•¸å€¼è§£ï¼ˆä»£å…¥å…·é«”æ•¸å­—ï¼‰                                           â”‚    â”‚
â”‚  â”‚  â€¢ æ¨å°æ­¥é©Ÿï¼ˆå¯è¿½è¹¤é©—è­‰ï¼‰                                           â”‚    â”‚
â”‚  â”‚  â€¢ å·¥ç¨‹å»ºè­°ï¼ˆå®‰å…¨ä¿‚æ•¸ï¼‰                                             â”‚    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â”‚                                                                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

#### Step 1: Agent åˆ†æå•é¡Œä¸¦è­˜åˆ¥ç¼ºå°‘åƒæ•¸

**Agent å…§éƒ¨åˆ†æ**:
```
å•é¡Œé¡å‹: ç¢°æ’åŠ›å­¸ + å®‰å…¨å¸¶å¼µåŠ›
æ¶‰åŠç‰©ç†æ¦‚å¿µ:
  1. äºŒç¶­éå½ˆæ€§ç¢°æ’ï¼ˆå‹•é‡å®ˆæ† + èƒ½é‡æå¤±ï¼‰
  2. äººåœ¨è»Šå…§çš„ç›¸å°é‹å‹•ï¼ˆæ¸›é€Ÿéç¨‹ï¼‰
  3. å½ˆç°§åŠ›å­¸ï¼ˆå®‰å…¨å¸¶ F = kxï¼‰

åƒæ•¸æª¢æŸ¥:
  âœ“ m   - äººçš„è³ªé‡
  âœ“ Mâ‚  - è»Šè¼› 1 è³ªé‡
  âœ“ Mâ‚‚  - è»Šè¼› 2 è³ªé‡
  âœ“ v   - åˆå§‹é€Ÿåº¦
  âœ“ Î¸   - ç¢°æ’è§’åº¦ (45Â°)
  âœ“ Î·   - èƒ½é‡ä¿ç•™æ¯”ä¾‹ (0.7)
  âœ“ k   - å®‰å…¨å¸¶å½ˆæ€§ä¿‚æ•¸
  
  âš ï¸ éœ€è¦ç¢ºèª:
  - ç¢°æ’é¡å‹: å®Œå…¨éå½ˆæ€§ or éƒ¨åˆ†éå½ˆæ€§?
  - å®‰å…¨å¸¶æ¨¡å‹: ç°¡å–®å½ˆç°§ or å«é˜»å°¼?
  - äººçš„åˆå§‹ç‹€æ…‹: èˆ‡è»ŠåŒé€Ÿ?
```

**Agent å‘ç”¨æˆ¶è©¢å•**:
```
æˆ‘åˆ†æäº†æ‚¨çš„å•é¡Œï¼Œéœ€è¦ç¢ºèªå¹¾å€‹åƒæ•¸ï¼š

1. ç¢°æ’å¾Œå…©è»Šæ˜¯å¦é»åœ¨ä¸€èµ·ï¼ˆå®Œå…¨éå½ˆæ€§ï¼‰é‚„æ˜¯åˆ†é–‹ï¼ˆéƒ¨åˆ†éå½ˆæ€§ï¼‰ï¼Ÿ
2. å®‰å…¨å¸¶æ˜¯å¦è€ƒæ…®é˜»å°¼æ•ˆæ‡‰ï¼Ÿé‚„æ˜¯ç°¡åŒ–ç‚ºç†æƒ³å½ˆç°§ï¼Ÿ
3. æ˜¯å¦éœ€è¦è€ƒæ…®å®‰å…¨å¸¶çš„é ç·ŠåŠ›ï¼Ÿ

å¦å¤–ï¼Œç‚ºäº†è¨ˆç®—ææ–™è€å—æ€§ï¼Œæˆ‘å»ºè­°ï¼š
- ä½¿ç”¨å®‰å…¨ä¿‚æ•¸ SF = 2.0ï¼ˆä¸€èˆ¬å·¥ç¨‹æ¨™æº–ï¼‰
- æˆ– SF = 3.0ï¼ˆå®‰å…¨é—œéµæ‡‰ç”¨ï¼‰

è«‹ç¢ºèªé€™äº›å‡è¨­æ˜¯å¦åˆç†ã€‚
```

#### Step 2: å‘¼å« MCP å·¥å…·é€²è¡Œç¬¦è™Ÿæ¨å°

**Tool Call 1: ç¢°æ’å¾Œé€Ÿåº¦è¨ˆç®—**

```json
{
    "tool": "physics_formula",
    "arguments": {
        "domain": "mechanics",
        "formula": "inelastic_collision_2d",
        "known_values": {
            "m1": "M1",
            "m2": "M2",
            "v1": "v",
            "v2": "0",
            "theta": "45",
            "energy_retention": "0.7",
            "collision_type": "partially_inelastic"
        },
        "solve_for": ["v1_final", "v2_final"],
        "show_derivation": true
    }
}
```

**MCP è¿”å›**:
```json
{
    "success": true,
    "problem_setup": {
        "description": "äºŒç¶­éƒ¨åˆ†éå½ˆæ€§ç¢°æ’",
        "coordinate_system": "x: ç¢°æ’æ–¹å‘, y: å‚ç›´æ–¹å‘",
        "initial_conditions": {
            "è»Š1": "vâ‚áµ¢ = vÂ·cos(45Â°)xÌ‚ + vÂ·sin(45Â°)Å·",
            "è»Š2": "vâ‚‚áµ¢ = 0"
        }
    },
    "derivation": [
        {
            "step": 1,
            "title": "å‹•é‡å®ˆæ†ï¼ˆx æ–¹å‘ï¼‰",
            "equation": "Mâ‚Â·vÂ·cos(Î¸) = Mâ‚Â·vâ‚â‚“' + Mâ‚‚Â·vâ‚‚â‚“'",
            "latex": "M_1 v \\cos\\theta = M_1 v_{1x}' + M_2 v_{2x}'"
        },
        {
            "step": 2,
            "title": "å‹•é‡å®ˆæ†ï¼ˆy æ–¹å‘ï¼‰",
            "equation": "Mâ‚Â·vÂ·sin(Î¸) = Mâ‚Â·vâ‚áµ§' + Mâ‚‚Â·vâ‚‚áµ§'",
            "latex": "M_1 v \\sin\\theta = M_1 v_{1y}' + M_2 v_{2y}'"
        },
        {
            "step": 3,
            "title": "èƒ½é‡æ¢ä»¶ï¼ˆä¿ç•™ 70%ï¼‰",
            "equation": "Â½Mâ‚vâ‚'Â² + Â½Mâ‚‚vâ‚‚'Â² = 0.7 Ã— Â½Mâ‚vÂ²",
            "latex": "\\frac{1}{2}M_1 v_1'^2 + \\frac{1}{2}M_2 v_2'^2 = 0.7 \\times \\frac{1}{2}M_1 v^2"
        },
        {
            "step": 4,
            "title": "æ±‚è§£è¯ç«‹æ–¹ç¨‹",
            "note": "éœ€è¦é¡å¤–æ¢ä»¶ï¼ˆå¦‚ç¢°æ’ä¿‚æ•¸ eï¼‰ä¾†å”¯ä¸€ç¢ºå®šè§£"
        }
    ],
    "result": {
        "v1_final": {
            "symbolic": "v * M1 * (1 + e*cos(2*theta)) / (2*(M1 + M2))",
            "latex": "v_1' = \\frac{M_1 v (1 + e\\cos 2\\theta)}{2(M_1 + M_2)}",
            "note": "e ç‚ºæ¢å¾©ä¿‚æ•¸ï¼Œç”±èƒ½é‡æ¢ä»¶ç¢ºå®š"
        },
        "velocity_change": {
            "symbolic": "Delta_v = v - v1_final",
            "description": "è»Š1ï¼ˆå«äººï¼‰çš„é€Ÿåº¦è®ŠåŒ–é‡"
        }
    },
    "assumptions_required": [
        "éœ€è¦æ¢å¾©ä¿‚æ•¸ e æˆ–æ›´å¤šç´„æŸæ¢ä»¶",
        "å»ºè­°ç°¡åŒ–ç‚ºæ­£å‘ç¢°æ’ä»¥ç²å¾—å°é–‰è§£"
    ]
}
```

**Tool Call 2: ç°¡åŒ–æ¨¡å‹ - æ­£å‘ç¢°æ’**

Agent æ±ºå®šå…ˆç”¨ç°¡åŒ–æ¨¡å‹ï¼Œå†è¨è«–è§’åº¦ä¿®æ­£ï¼š

```json
{
    "tool": "physics_formula",
    "arguments": {
        "domain": "mechanics",
        "formula": "inelastic_collision_1d",
        "known_values": {
            "m1": "M1",
            "m2": "M2",
            "v1": "v",
            "v2": "0",
            "energy_retention": "0.7"
        },
        "solve_for": "v_final",
        "show_derivation": true
    }
}
```

**MCP è¿”å›**:
```json
{
    "success": true,
    "derivation": [
        {
            "step": 1,
            "title": "å‹•é‡å®ˆæ†",
            "equation": "Mâ‚Â·v = (Mâ‚ + Mâ‚‚)Â·v'",
            "result": "v' = Mâ‚Â·v / (Mâ‚ + Mâ‚‚)"
        },
        {
            "step": 2,
            "title": "é€Ÿåº¦è®ŠåŒ–é‡",
            "equation": "Î”v = v - v' = vÂ·Mâ‚‚/(Mâ‚ + Mâ‚‚)",
            "latex": "\\Delta v = \\frac{M_2 v}{M_1 + M_2}"
        },
        {
            "step": 3,
            "title": "è§’åº¦ä¿®æ­£ï¼ˆ45Â° ç¢°æ’ï¼‰",
            "equation": "Î”v_eff = Î”v Â· cos(45Â°) = Î”v / âˆš2",
            "note": "æœ‰æ•ˆæ¸›é€Ÿæ²¿ç¢°æ’æ–¹å‘"
        }
    ],
    "result": {
        "velocity_change": {
            "symbolic": "M2 * v / (M1 + M2)",
            "with_angle": "M2 * v * cos(theta) / (M1 + M2)",
            "latex": "\\Delta v = \\frac{M_2 v \\cos\\theta}{M_1 + M_2}"
        }
    }
}
```

**Tool Call 3: å®‰å…¨å¸¶å¼µåŠ›è¨ˆç®—**

```json
{
    "tool": "symbolic_calculate",
    "arguments": {
        "operation": "derive",
        "context": "seatbelt_tension",
        "given": {
            "mass": "m",
            "velocity_change": "Delta_v",
            "spring_constant": "k",
            "model": "energy_conservation"
        },
        "derive": ["extension_x", "tension_T", "deceleration_a"],
        "show_derivation": true
    }
}
```

**MCP è¿”å›**:
```json
{
    "success": true,
    "derivation": [
        {
            "step": 1,
            "title": "èƒ½é‡å®ˆæ†",
            "description": "äººçš„å‹•èƒ½è½‰æ›ç‚ºå®‰å…¨å¸¶å½ˆæ€§ä½èƒ½",
            "equation": "Â½m(Î”v)Â² = Â½kxÂ²",
            "latex": "\\frac{1}{2}m(\\Delta v)^2 = \\frac{1}{2}kx^2"
        },
        {
            "step": 2,
            "title": "æ±‚å®‰å…¨å¸¶ä¼¸é•·é‡",
            "equation": "x = Î”vÂ·âˆš(m/k)",
            "latex": "x = \\Delta v \\sqrt{\\frac{m}{k}}"
        },
        {
            "step": 3,
            "title": "æœ€å¤§å¼µåŠ›ï¼ˆåœ¨æœ€å¤§ä¼¸é•·æ™‚ï¼‰",
            "equation": "T_max = kÂ·x = Î”vÂ·âˆš(mÂ·k)",
            "latex": "T_{max} = k \\cdot x = \\Delta v \\sqrt{mk}"
        },
        {
            "step": 4,
            "title": "ç­‰æ•ˆæ¸›é€Ÿåº¦",
            "equation": "a = T_max/m = Î”vÂ·âˆš(k/m)",
            "latex": "a = \\frac{T_{max}}{m} = \\Delta v \\sqrt{\\frac{k}{m}}"
        }
    ],
    "result": {
        "extension": {
            "symbolic": "Delta_v * sqrt(m/k)",
            "latex": "x = \\Delta v \\sqrt{\\frac{m}{k}}"
        },
        "max_tension": {
            "symbolic": "Delta_v * sqrt(m*k)",
            "latex": "T_{max} = \\Delta v \\sqrt{mk}",
            "expanded": "(M2 * v * cos(theta) / (M1 + M2)) * sqrt(m * k)"
        },
        "deceleration": {
            "symbolic": "Delta_v * sqrt(k/m)",
            "latex": "a = \\Delta v \\sqrt{\\frac{k}{m}}",
            "unit": "m/sÂ²"
        }
    },
    "complete_formula": {
        "T_max": {
            "symbolic": "M2 * v * cos(theta) * sqrt(m * k) / (M1 + M2)",
            "latex": "T_{max} = \\frac{M_2 v \\cos\\theta \\sqrt{mk}}{M_1 + M_2}"
        }
    }
}
```

**Tool Call 4: ææ–™å®‰å…¨ä¿‚æ•¸è¨ˆç®—**

```json
{
    "tool": "symbolic_calculate",
    "arguments": {
        "operation": "engineering_design",
        "context": "material_strength",
        "given": {
            "max_load": "T_max",
            "safety_factor": "SF"
        },
        "calculate": "required_strength"
    }
}
```

**MCP è¿”å›**:
```json
{
    "success": true,
    "result": {
        "required_strength": {
            "symbolic": "T_max * SF",
            "latex": "\\sigma_{required} = T_{max} \\times SF"
        },
        "with_values": {
            "SF_2.0": "T_max Ã— 2.0ï¼ˆä¸€èˆ¬æ‡‰ç”¨ï¼‰",
            "SF_3.0": "T_max Ã— 3.0ï¼ˆå®‰å…¨é—œéµï¼‰"
        }
    },
    "engineering_notes": [
        "å®‰å…¨å¸¶é€šå¸¸è¨­è¨ˆç‚ºæ‰¿å— 3G ä»¥ä¸Šæ¸›é€Ÿ",
        "å»ºè­°ææ–™æŠ—æ‹‰å¼·åº¦ > 3 Ã— T_max",
        "éœ€è€ƒæ…®å‹•æ…‹è¼‰è·å› å­ï¼ˆé€šå¸¸ 1.5-2.0ï¼‰"
    ]
}
```

#### Step 3: Agent æ•´åˆçµæœ

**æœ€çµ‚å›ç­”ï¼ˆAgent æä¾›çµ¦ç”¨æˆ¶ï¼‰**:

```markdown
## ğŸš— è»Šè¼›ç¢°æ’å®‰å…¨å¸¶å¼µåŠ›åˆ†æçµæœ

### å•é¡Œè¨­å®š
- äººçš„è³ªé‡: m
- è»Šè¼› 1 è³ªé‡: Mâ‚
- è»Šè¼› 2 è³ªé‡: Mâ‚‚  
- åˆé€Ÿåº¦: v
- ç¢°æ’è§’åº¦: Î¸ = 45Â°
- èƒ½é‡æå¤±: 30%ï¼ˆä¿ç•™ 70%ï¼‰
- å®‰å…¨å¸¶å½ˆæ€§ä¿‚æ•¸: k

### ğŸ“ æ¨å°çµæœ

#### 1. é€Ÿåº¦è®ŠåŒ–é‡

$$\Delta v = \frac{M_2 v \cos\theta}{M_1 + M_2}$$

#### 2. å®‰å…¨å¸¶ä¼¸é•·é‡

$$x = \Delta v \sqrt{\frac{m}{k}} = \frac{M_2 v \cos\theta}{M_1 + M_2} \sqrt{\frac{m}{k}}$$

#### 3. æœ€å¤§å¼µåŠ› â­

$$T_{max} = \frac{M_2 v \cos\theta \sqrt{mk}}{M_1 + M_2}$$

#### 4. äººæ‰¿å—çš„æ¸›é€Ÿåº¦

$$a = \frac{T_{max}}{m} = \frac{M_2 v \cos\theta}{M_1 + M_2} \sqrt{\frac{k}{m}}$$

### ğŸ”§ ææ–™è¨­è¨ˆå»ºè­°

| æ‡‰ç”¨ç­‰ç´š | å®‰å…¨ä¿‚æ•¸ SF | ææ–™å¼·åº¦è¦æ±‚ |
|---------|------------|-------------|
| ä¸€èˆ¬æ‡‰ç”¨ | 2.0 | $\geq 2 \times T_{max}$ |
| å®‰å…¨é—œéµ | 3.0 | $\geq 3 \times T_{max}$ |
| èˆªç©ºæ¨™æº– | 4.0 | $\geq 4 \times T_{max}$ |

### ğŸ“Š æ•¸å€¼è¨ˆç®—ç¯„ä¾‹

è‹¥ä»£å…¥å…·é«”æ•¸å€¼ï¼š
- m = 70 kgï¼ˆäººï¼‰
- Mâ‚ = 1500 kgï¼ˆå°è½è»Šï¼‰
- Mâ‚‚ = 2000 kgï¼ˆå¦ä¸€è»Šï¼‰
- v = 50 km/h = 13.89 m/s
- k = 5000 N/m
- Î¸ = 45Â°

**è¨ˆç®—çµæœ**:
- Î”v = 5.61 m/s
- x = 0.66 mï¼ˆå®‰å…¨å¸¶ä¼¸é•·ï¼‰
- T_max = 3,318 N
- a = 47.4 m/sÂ² â‰ˆ 4.8 G
- ææ–™å¼·åº¦ï¼ˆSF=3ï¼‰: â‰¥ 9,954 N

### âš ï¸ æ³¨æ„äº‹é …

1. æ­¤æ¨¡å‹ç°¡åŒ–ç‚ºç†æƒ³å½ˆç°§ï¼Œå¯¦éš›å®‰å…¨å¸¶æœ‰é ç·Šå™¨å’Œé™åŠ›å™¨
2. æœªè€ƒæ…®äººé«”æ’æ“Šæ–¹å‘ç›¤/æ°£å›Šçš„æƒ…æ³
3. 4.8G æ¸›é€Ÿåº¦åœ¨äººé«”å¯æ‰¿å—ç¯„åœå…§ï¼ˆçŸ­æ™‚é–“ï¼‰
4. å»ºè­°é€²è¡Œæ›´ç²¾ç¢ºçš„æœ‰é™å…ƒç´ åˆ†æ

---
*æ‰€æœ‰è¨ˆç®—å‡ç”±ç¬¦è™Ÿå¼•æ“åŸ·è¡Œï¼Œçµæœå¯é‡ç¾ä¸”å¯é©—è­‰*
```

#### é€™å€‹ç¯„ä¾‹å±•ç¤ºçš„åƒ¹å€¼

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                         æœ¬å°ˆæ¡ˆçš„æ ¸å¿ƒåƒ¹å€¼                                    â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                             â”‚
â”‚  1ï¸âƒ£ ç²¾ç¢ºçš„ç¬¦è™Ÿæ¨å°                                                          â”‚
â”‚     â€¢ å…¬å¼æ¨å°ç”±ç¬¦è™Ÿå¼•æ“åŸ·è¡Œï¼Œä¸æ˜¯ LLM çŒœæ¸¬                                 â”‚
â”‚     â€¢ æ¯å€‹æ­¥é©Ÿéƒ½å¯è¿½è¹¤ã€å¯é©—è­‰                                              â”‚
â”‚     â€¢ çµæœ 100% å¯é‡ç¾                                                      â”‚
â”‚                                                                             â”‚
â”‚  2ï¸âƒ£ æ™ºèƒ½åƒæ•¸æª¢æŸ¥                                                            â”‚
â”‚     â€¢ Agent è‡ªå‹•è­˜åˆ¥ç¼ºå°‘çš„åƒæ•¸                                              â”‚
â”‚     â€¢ ä¸»å‹•èˆ‡ç”¨æˆ¶è¨è«–å‡è¨­æ¢ä»¶                                                â”‚
â”‚     â€¢ æä¾›åˆç†çš„é è¨­å€¼å»ºè­°                                                  â”‚
â”‚                                                                             â”‚
â”‚  3ï¸âƒ£ åˆ†æ­¥æ¨å°é€æ˜åŒ–                                                          â”‚
â”‚     â€¢ å¾åŸºæœ¬ç‰©ç†å®šå¾‹å‡ºç™¼                                                    â”‚
â”‚     â€¢ æ¯æ­¥æ¨å°éƒ½æœ‰ç‰©ç†æ„ç¾©èªªæ˜                                              â”‚
â”‚     â€¢ ä¾¿æ–¼å­¸ç¿’å’Œæ•™å­¸                                                        â”‚
â”‚                                                                             â”‚
â”‚  4ï¸âƒ£ ç¬¦è™Ÿè§£ + æ•¸å€¼è§£çµåˆ                                                     â”‚
â”‚     â€¢ å…ˆå¾—åˆ°é€šç”¨å…¬å¼ï¼ˆç¬¦è™Ÿè§£ï¼‰                                              â”‚
â”‚     â€¢ å†ä»£å…¥å…·é«”æ•¸å€¼è¨ˆç®—                                                    â”‚
â”‚     â€¢ æ”¯æ´åƒæ•¸æ•æ„Ÿæ€§åˆ†æ                                                    â”‚
â”‚                                                                             â”‚
â”‚  5ï¸âƒ£ å·¥ç¨‹å¯¦å‹™æ•´åˆ                                                            â”‚
â”‚     â€¢ æä¾›å®‰å…¨ä¿‚æ•¸å»ºè­°                                                      â”‚
â”‚     â€¢ åŒ…å«å¯¦éš›æ‡‰ç”¨æ³¨æ„äº‹é …                                                  â”‚
â”‚     â€¢ é€£çµåˆ°é€²éšåˆ†ææ–¹æ³•                                                    â”‚
â”‚                                                                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

### 6.6 ğŸ¥ è—¥ç‰©å‹•åŠ›å­¸æ¨å°ç¯„ä¾‹ï¼ˆPharmacokineticsï¼‰

é€™å€‹ç¯„ä¾‹å±•ç¤ºå¦‚ä½•ç”¨ Derivation DSL è™•ç†**è‡¨åºŠè—¥ç†å­¸å•é¡Œ**ï¼ŒåŒ…æ‹¬è—¥ç‰©å¸æ”¶ã€åˆ†å¸ƒã€ä»£è¬å’Œæ’é™¤çš„å®Œæ•´å»ºæ¨¡ã€‚

#### å•é¡Œæè¿°

```
å ´æ™¯ï¼šå£æœè—¥ç‰©çš„è—¥å‹•å­¸åˆ†æ
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
å·²çŸ¥æ¢ä»¶ï¼š
  â€¢ åŠ‘é‡ D = 100 mgï¼ˆå£æœï¼‰
  â€¢ ç”Ÿé«”å¯ç”¨ç‡ F = 0.7ï¼ˆ30% é¦–æ¸¡æ•ˆæ‡‰ï¼‰
  â€¢ åˆ†å¸ƒé«”ç© Vd = 0.5 L/kg
  â€¢ æ¶ˆé™¤é€Ÿç‡å¸¸æ•¸ k_el = 0.1 /hr
  â€¢ é«”é‡ BW = 70 kg
  â€¢ è¡€è…¦å±éšœé€šé€æ€§ P_BBB = 0.05
  â€¢ è…¦çµ„ç¹”åˆ†é…ä¿‚æ•¸ Kp_brain = 2.0
  â€¢ æœ€ä½æœ‰æ•ˆæ¿ƒåº¦ C_min = 5 mg/L
  â€¢ ç›®æ¨™ç©©æ…‹æ¿ƒåº¦ C_ss_target = 20 mg/L

å•é¡Œï¼š
  1. å£æœå¾Œç³»çµ±å¯ç”¨åŠ‘é‡ï¼Ÿ
  2. è¡€æ¼¿æ¿ƒåº¦éš¨æ™‚é–“è®ŠåŒ–ï¼Ÿ
  3. è…¦éƒ¨è—¥ç‰©æ¿ƒåº¦ï¼Ÿ
  4. è—¥æ•ˆæŒçºŒæ™‚é–“ï¼Ÿ
  5. ç¶­æŒç©©æ…‹éœ€è¦çš„é»æ»´é€Ÿç‡ï¼Ÿ
  6. è² è·åŠ‘é‡ï¼Ÿ
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
```

#### æ¨å°è…³æœ¬ï¼šè—¥ç‰©å‹•åŠ›å­¸åˆ†æ

```yaml
derivation:
  name: "å£æœè—¥ç‰©è—¥å‹•å­¸åˆ†æ"
  domain: "pharmacokinetics"
  level: "3.5"  # å¤šæ­¥æ¨å° + ODE
  
  # === ç¬¦è™Ÿå®šç¾© ===
  symbols:
    # è—¥ç‰©åƒæ•¸
    - {name: D, type: positive_real, unit: mg, description: "å£æœåŠ‘é‡"}
    - {name: F, type: fraction, unit: dimensionless, description: "ç”Ÿé«”å¯ç”¨ç‡ (0-1)"}
    - {name: Vd, type: positive_real, unit: L/kg, description: "åˆ†å¸ƒé«”ç©"}
    - {name: k_el, type: positive_real, unit: 1/hr, description: "æ¶ˆé™¤é€Ÿç‡å¸¸æ•¸"}
    - {name: BW, type: positive_real, unit: kg, description: "é«”é‡"}
    
    # è¡€è…¦å±éšœåƒæ•¸
    - {name: P_BBB, type: fraction, unit: dimensionless, description: "BBB é€šé€æ€§ä¿‚æ•¸"}
    - {name: Kp_brain, type: positive_real, unit: dimensionless, description: "è…¦çµ„ç¹”åˆ†é…ä¿‚æ•¸"}
    
    # æ²»ç™‚åƒæ•¸
    - {name: C_min, type: positive_real, unit: mg/L, description: "æœ€ä½æœ‰æ•ˆæ¿ƒåº¦"}
    - {name: C_ss_target, type: positive_real, unit: mg/L, description: "ç›®æ¨™ç©©æ…‹æ¿ƒåº¦"}
    
    # æ™‚é–“è®Šæ•¸
    - {name: t, type: positive_real, unit: hr, description: "æ™‚é–“"}
    
    # å°å‡ºé‡
    - {name: C, type: positive_real, unit: mg/L, description: "è¡€æ¼¿è—¥ç‰©æ¿ƒåº¦"}
    - {name: C_brain, type: positive_real, unit: mg/L, description: "è…¦éƒ¨è—¥ç‰©æ¿ƒåº¦"}
  
  # === æ¨å°æ­¥é©Ÿ ===
  steps:
    # --- Part 1: åŸºæœ¬è—¥å‹•å­¸ ---
    - id: pk_1
      action: calculate_systemic_dose
      description: "è¨ˆç®—ç³»çµ±å¯ç”¨åŠ‘é‡ï¼ˆé¦–æ¸¡æ•ˆæ‡‰å¾Œï¼‰"
      formula: "D_systemic = D Ã— F"
      inputs: [D, F]
      result: D_systemic
      note: "é¦–æ¸¡æ•ˆæ‡‰ï¼šè‚è‡Ÿé¦–æ¬¡ä»£è¬æ¸›å°‘è—¥ç‰©é€²å…¥ç³»çµ±å¾ªç’°çš„é‡"
      
    - id: pk_2
      action: calculate_initial_concentration
      description: "è¨ˆç®—åˆå§‹è¡€æ¼¿æ¿ƒåº¦"
      formula: "C_0 = D_systemic / (Vd Ã— BW)"
      inputs: [D_systemic, Vd, BW]
      result: C_0
      unit: mg/L
      
    - id: pk_3
      action: derive_concentration_profile
      description: "æ¨å°è¡€æ¼¿æ¿ƒåº¦éš¨æ™‚é–“è®ŠåŒ–ï¼ˆä¸€å®¤æ¨¡å‹ï¼‰"
      model: "one_compartment_first_order"
      differential_equation: "dC/dt = -k_el Ã— C"
      initial_condition: "C(0) = C_0"
      method: "separation_of_variables"
      derivation:
        - step: "åˆ†é›¢è®Šæ•¸: dC/C = -k_el dt"
        - step: "å…©é‚Šç©åˆ†: ln(C) = -k_el Ã— t + const"
        - step: "ä»£å…¥åˆå§‹æ¢ä»¶: ln(C_0) = const"
        - step: "è§£å‡º: C(t) = C_0 Ã— e^(-k_el Ã— t)"
      result: C_t
      formula: "C(t) = C_0 Ã— exp(-k_el Ã— t)"
      
    - id: pk_4
      action: calculate_half_life
      description: "è¨ˆç®—åŠè¡°æœŸ"
      formula: "t_half = ln(2) / k_el"
      inputs: [k_el]
      result: t_half
      unit: hr
      note: "æ¿ƒåº¦é™è‡³ä¸€åŠæ‰€éœ€æ™‚é–“"
      
    - id: pk_5
      action: calculate_clearance
      description: "è¨ˆç®—æ¸…é™¤ç‡"
      formula: "CL = k_el Ã— Vd Ã— BW"
      inputs: [k_el, Vd, BW]
      result: CL
      unit: L/hr
      note: "å–®ä½æ™‚é–“å…§æ¸…é™¤çš„è¡€æ¼¿é«”ç©"
      
    # --- Part 2: è¡€è…¦å±éšœç©¿é€ ---
    - id: bbb_1
      action: derive_brain_concentration
      description: "è¨ˆç®—è…¦éƒ¨è—¥ç‰©æ¿ƒåº¦"
      model: "equilibrium_partitioning"
      formula: "C_brain = C_plasma Ã— Kp_brain Ã— P_BBB"
      inputs: [C_t, Kp_brain, P_BBB]
      result: C_brain_t
      note: "å‡è¨­å¿«é€Ÿå¹³è¡¡ï¼Œè…¦æ¿ƒåº¦è¿½éš¨è¡€æ¼¿æ¿ƒåº¦"
      
    - id: bbb_2
      action: calculate_brain_to_plasma_ratio
      description: "è…¦/è¡€æ¼¿æ¿ƒåº¦æ¯”"
      formula: "R_bp = Kp_brain Ã— P_BBB"
      inputs: [Kp_brain, P_BBB]
      result: R_bp
      note: "å¯¦éš›è…¦éƒ¨ç©¿é€æ•ˆç‡"
      
    # --- Part 3: ç™‚æ•ˆæŒçºŒæ™‚é–“ ---
    - id: duration_1
      action: solve_for_time
      description: "æ±‚è—¥æ•ˆæŒçºŒæ™‚é–“ï¼ˆæ¿ƒåº¦é™è‡³ C_minï¼‰"
      equation: "C(t_end) = C_min"
      substitution: "C_0 Ã— exp(-k_el Ã— t_end) = C_min"
      solve_for: t_end
      derivation:
        - step: "å–å°æ•¸: ln(C_0) - k_el Ã— t_end = ln(C_min)"
        - step: "ç§»é …: t_end = (ln(C_0) - ln(C_min)) / k_el"
        - step: "ç°¡åŒ–: t_end = ln(C_0/C_min) / k_el"
      result: t_duration
      formula: "t_duration = (1/k_el) Ã— ln(C_0 / C_min)"
      
    # --- Part 4: é€£çºŒé»æ»´è¨­è¨ˆ ---
    - id: infusion_1
      action: derive_steady_state
      description: "é€£çºŒé»æ»´ç©©æ…‹æ¿ƒåº¦"
      model: "constant_rate_infusion"
      differential_equation: "dC/dt = R_infusion/V - k_el Ã— C"
      steady_state_condition: "dC/dt = 0"
      derivation:
        - step: "ç©©æ…‹æ™‚ dC/dt = 0"
        - step: "R_infusion/V = k_el Ã— C_ss"
        - step: "C_ss = R_infusion / (k_el Ã— V)"
        - step: "æˆ– C_ss = R_infusion / CL"
      result: C_ss
      formula: "C_ss = R_infusion / CL"
      
    - id: infusion_2
      action: solve_for_infusion_rate
      description: "æ±‚é”åˆ°ç›®æ¨™æ¿ƒåº¦çš„é»æ»´é€Ÿç‡"
      equation: "C_ss_target = R_infusion / CL"
      solve_for: R_infusion
      result: R_infusion_required
      formula: "R_infusion = C_ss_target Ã— CL"
      unit: mg/hr
      
    - id: infusion_3
      action: calculate_loading_dose
      description: "è¨ˆç®—è² è·åŠ‘é‡ï¼ˆç«‹å³é”åˆ°ç›®æ¨™æ¿ƒåº¦ï¼‰"
      formula: "D_loading = C_target Ã— Vd Ã— BW"
      inputs: [C_ss_target, Vd, BW]
      result: D_loading
      unit: mg
      note: "çµ¦äºˆè² è·åŠ‘é‡å¾Œé–‹å§‹ç¶­æŒé»æ»´"
      
    - id: infusion_4
      action: derive_approach_to_steady_state
      description: "é»æ»´æ¿ƒåº¦éš¨æ™‚é–“è®ŠåŒ–"
      model: "loading_dose_plus_infusion"
      formula: "C(t) = C_ss Ã— (1 - exp(-k_el Ã— t)) + C_loading Ã— exp(-k_el Ã— t)"
      note: "è‹¥æœ‰è² è·åŠ‘é‡ï¼Œå‰‡ C_loading = C_ss_target"
      result: C_infusion_t
      
  # === æ•¸å€¼è¨ˆç®—ç¯„ä¾‹ ===
  numerical_example:
    parameters:
      D: 100        # mg
      F: 0.7        # ç”Ÿé«”å¯ç”¨ç‡
      Vd: 0.5       # L/kg
      k_el: 0.1     # /hr
      BW: 70        # kg
      P_BBB: 0.05   # BBB é€šé€æ€§
      Kp_brain: 2.0 # è…¦åˆ†é…ä¿‚æ•¸
      C_min: 5      # mg/L
      C_ss_target: 20  # mg/L
      
    calculations:
      step_1:
        name: "ç³»çµ±å¯ç”¨åŠ‘é‡"
        formula: "D_systemic = D Ã— F = 100 Ã— 0.7"
        result: "70 mg"
        
      step_2:
        name: "åˆ†å¸ƒé«”ç©ï¼ˆç¸½ï¼‰"
        formula: "V = Vd Ã— BW = 0.5 Ã— 70"
        result: "35 L"
        
      step_3:
        name: "åˆå§‹æ¿ƒåº¦"
        formula: "C_0 = D_systemic / V = 70 / 35"
        result: "2 mg/L"
        
      step_4:
        name: "åŠè¡°æœŸ"
        formula: "t_half = ln(2) / k_el = 0.693 / 0.1"
        result: "6.93 hr"
        
      step_5:
        name: "æ¸…é™¤ç‡"
        formula: "CL = k_el Ã— V = 0.1 Ã— 35"
        result: "3.5 L/hr"
        
      step_6:
        name: "è…¦/è¡€æ¼¿æ¯”"
        formula: "R_bp = Kp_brain Ã— P_BBB = 2.0 Ã— 0.05"
        result: "0.10 (10% ç©¿é€)"
        
      step_7:
        name: "è—¥æ•ˆæŒçºŒæ™‚é–“"
        formula: "t_duration = ln(C_0/C_min) / k_el = ln(2/5) / 0.1"
        result: "ç„¡æ³•æŒçºŒï¼ˆC_0 < C_minï¼éœ€è¦æ›´é«˜åŠ‘é‡ï¼‰"
        note: "âš ï¸ åˆå§‹æ¿ƒåº¦ 2 mg/L ä½æ–¼æœ€ä½æœ‰æ•ˆæ¿ƒåº¦ 5 mg/L"
        
      step_8:
        name: "ç¶­æŒç›®æ¨™æ¿ƒåº¦çš„é»æ»´é€Ÿç‡"
        formula: "R_infusion = C_ss_target Ã— CL = 20 Ã— 3.5"
        result: "70 mg/hr"
        
      step_9:
        name: "è² è·åŠ‘é‡"
        formula: "D_loading = C_ss_target Ã— V = 20 Ã— 35"
        result: "700 mg"
        
    clinical_interpretation:
      problem_identified: |
        å£æœ 100 mg ç„¡æ³•é”åˆ°æœ‰æ•ˆæ¿ƒåº¦ï¼
        - åˆå§‹æ¿ƒåº¦ C_0 = 2 mg/L < C_min = 5 mg/L
        - åŸå› ï¼šé¦–æ¸¡æ•ˆæ‡‰ (30%) + å¤§åˆ†å¸ƒé«”ç©
        
      recommendations:
        - option_1: "å¢åŠ å£æœåŠ‘é‡è‡³ 250 mg â†’ C_0 â‰ˆ 5 mg/L"
        - option_2: "ä½¿ç”¨éœè„ˆæ³¨å°„ï¼ˆé¿é–‹é¦–æ¸¡æ•ˆæ‡‰ï¼‰"
        - option_3: "æ¡ç”¨è² è·åŠ‘é‡ 700 mg + æŒçºŒé»æ»´ 70 mg/hr"
        
      safety_check:
        - "ç¢ºèªè—¥ç‰©çš„æœ€å¤§å®‰å…¨åŠ‘é‡"
        - "ç›£æ¸¬ 700 mg è² è·åŠ‘é‡æ˜¯å¦è¶…éå®‰å…¨ä¸Šé™"
        - "è€ƒæ…®åˆ†æ¬¡çµ¦è—¥ä»¥é™ä½å³°å€¼æ¿ƒåº¦é¢¨éšª"
  
  # === è¼¸å‡º ===
  outputs:
    - name: concentration_profile
      description: "è¡€æ¼¿æ¿ƒåº¦-æ™‚é–“æ›²ç·š"
      formula_latex: "C(t) = C_0 e^{-k_{el}t}"
      plot_type: "exponential_decay"
      
    - name: brain_concentration
      description: "è…¦éƒ¨æ¿ƒåº¦-æ™‚é–“æ›²ç·š"
      formula_latex: "C_{brain}(t) = R_{bp} \\cdot C_0 e^{-k_{el}t}"
      
    - name: infusion_design
      description: "é»æ»´æ²»ç™‚æ–¹æ¡ˆ"
      components:
        - "è² è·åŠ‘é‡: D_loading"
        - "ç¶­æŒé€Ÿç‡: R_infusion"
        - "é”ç©©æ…‹æ™‚é–“: ~5 Ã— t_half"
        
    - name: pk_parameters_summary
      description: "è—¥å‹•å­¸åƒæ•¸ç¸½è¡¨"
      columns: [Parameter, Symbol, Value, Unit, Clinical Meaning]
```

### DSL åŸ·è¡Œçµæœç¯„ä¾‹

ç•¶ Agent è«‹æ±‚åˆ†æè—¥å‹•å­¸å•é¡Œæ™‚ï¼ŒMCP Server è¿”å›ï¼š

```json
{
  "analysis_type": "pharmacokinetics_oral_drug",
  "model": "one_compartment_first_order",
  
  "pk_parameters": {
    "D_systemic": {"value": 70, "unit": "mg", "formula": "D Ã— F"},
    "V_total": {"value": 35, "unit": "L", "formula": "Vd Ã— BW"},
    "C_0": {"value": 2, "unit": "mg/L", "formula": "D_systemic / V"},
    "t_half": {"value": 6.93, "unit": "hr", "formula": "ln(2) / k_el"},
    "CL": {"value": 3.5, "unit": "L/hr", "formula": "k_el Ã— V"}
  },
  
  "concentration_equations": {
    "plasma": {
      "latex": "C(t) = 2 \\cdot e^{-0.1t} \\text{ mg/L}",
      "sympy": "2 * exp(-0.1*t)"
    },
    "brain": {
      "latex": "C_{brain}(t) = 0.2 \\cdot e^{-0.1t} \\text{ mg/L}",
      "sympy": "0.2 * exp(-0.1*t)",
      "note": "R_bp = 0.10"
    }
  },
  
  "therapeutic_assessment": {
    "efficacy_achievable": false,
    "issue": "C_0 (2 mg/L) < C_min (5 mg/L)",
    "duration_above_Cmin": "0 hr (never reaches therapeutic level)"
  },
  
  "infusion_design": {
    "loading_dose": {"value": 700, "unit": "mg", "formula": "C_target Ã— V"},
    "maintenance_rate": {"value": 70, "unit": "mg/hr", "formula": "C_ss Ã— CL"},
    "time_to_steady_state": {"value": 34.65, "unit": "hr", "formula": "5 Ã— t_half"}
  },
  
  "clinical_recommendations": [
    {
      "priority": 1,
      "issue": "å£æœåŠ‘é‡ä¸è¶³",
      "solution": "å¢åŠ å£æœåŠ‘é‡è‡³ â‰¥250 mg æˆ–æ”¹ç”¨éœè„ˆçµ¦è—¥",
      "calculation": "éœ€è¦ C_0 â‰¥ 5 mg/L â†’ D_systemic â‰¥ 175 mg â†’ D_oral â‰¥ 250 mg"
    },
    {
      "priority": 2,
      "issue": "éœ€è¦å¿«é€Ÿé”åˆ°ç™‚æ•ˆ",
      "solution": "éœè„ˆè² è·åŠ‘é‡ 700 mg + ç¶­æŒé»æ»´ 70 mg/hr",
      "caution": "ç¢ºèª 700 mg æœªè¶…éæœ€å¤§å®‰å…¨åŠ‘é‡"
    },
    {
      "priority": 3,
      "issue": "è…¦éƒ¨æ¿ƒåº¦åä½",
      "solution": "è…¦/è¡€æ¼¿æ¯”åƒ… 0.10ï¼Œå¯èƒ½éœ€è¦æ›´é«˜è¡€æ¼¿æ¿ƒåº¦æ‰èƒ½é”åˆ° CNS ç™‚æ•ˆ",
      "calculation": "è‹¥éœ€è…¦éƒ¨ 1 mg/Lï¼Œè¡€æ¼¿éœ€é” 10 mg/L"
    }
  ],
  
  "derivation_trace": [
    {"step": 1, "action": "è¨ˆç®—ç³»çµ±å¯ç”¨åŠ‘é‡", "result": "70 mg", "status": "âœ“"},
    {"step": 2, "action": "è¨ˆç®—åˆ†å¸ƒé«”ç©", "result": "35 L", "status": "âœ“"},
    {"step": 3, "action": "è¨ˆç®—åˆå§‹æ¿ƒåº¦", "result": "2 mg/L", "status": "âœ“"},
    {"step": 4, "action": "æ¨å°æ¿ƒåº¦-æ™‚é–“æ–¹ç¨‹", "result": "C(t)=Câ‚€e^(-k_elÃ—t)", "status": "âœ“"},
    {"step": 5, "action": "è¨ˆç®—åŠè¡°æœŸ", "result": "6.93 hr", "status": "âœ“"},
    {"step": 6, "action": "è¨ˆç®—æ¸…é™¤ç‡", "result": "3.5 L/hr", "status": "âœ“"},
    {"step": 7, "action": "è¨ˆç®—è…¦éƒ¨ç©¿é€", "result": "R_bp = 0.10", "status": "âœ“"},
    {"step": 8, "action": "è©•ä¼°ç™‚æ•ˆæŒçºŒæ™‚é–“", "result": "ç„¡æ³•é”æ¨™", "status": "âš ï¸"},
    {"step": 9, "action": "è¨­è¨ˆé»æ»´æ–¹æ¡ˆ", "result": "700 mg + 70 mg/hr", "status": "âœ“"}
  ],
  
  "warnings": [
    "âš ï¸ å£æœåŠ‘é‡ç„¡æ³•é”åˆ°æœ‰æ•ˆæ¿ƒåº¦",
    "âš ï¸ è² è·åŠ‘é‡ 700 mg éœ€ç¢ºèªå®‰å…¨æ€§",
    "âš ï¸ è…¦éƒ¨ç©¿é€ç‡ä½ï¼ŒCNS ç™‚æ•ˆå¯èƒ½å—é™"
  ]
}
```

### è—¥å‹•å­¸ç¯„ä¾‹å±•ç¤ºçš„åƒ¹å€¼

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                     è—¥å‹•å­¸ DSL çš„è‡¨åºŠæ‡‰ç”¨åƒ¹å€¼                               â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                             â”‚
â”‚  1ï¸âƒ£ å®Œæ•´çš„ ADME å»ºæ¨¡                                                        â”‚
â”‚     â€¢ Absorption: é¦–æ¸¡æ•ˆæ‡‰ã€ç”Ÿé«”å¯ç”¨ç‡                                      â”‚
â”‚     â€¢ Distribution: åˆ†å¸ƒé«”ç©ã€çµ„ç¹”åˆ†é…                                      â”‚
â”‚     â€¢ Metabolism: æ¸…é™¤ç‡                                                    â”‚
â”‚     â€¢ Excretion: æ¶ˆé™¤é€Ÿç‡ã€åŠè¡°æœŸ                                           â”‚
â”‚                                                                             â”‚
â”‚  2ï¸âƒ£ ODE ç¬¦è™Ÿæ±‚è§£                                                            â”‚
â”‚     â€¢ ä¸€å®¤æ¨¡å‹å¾®åˆ†æ–¹ç¨‹è‡ªå‹•æ¨å°                                              â”‚
â”‚     â€¢ è§£æè§£ç”Ÿæˆï¼ˆéæ•¸å€¼è¿‘ä¼¼ï¼‰                                              â”‚
â”‚     â€¢ å¯æ“´å±•åˆ°å¤šå®¤æ¨¡å‹                                                      â”‚
â”‚                                                                             â”‚
â”‚  3ï¸âƒ£ ç‰¹æ®Šå±éšœç©¿é€                                                            â”‚
â”‚     â€¢ è¡€è…¦å±éšœ (BBB) å»ºæ¨¡                                                   â”‚
â”‚     â€¢ çµ„ç¹”åˆ†é…ä¿‚æ•¸æ•´åˆ                                                      â”‚
â”‚     â€¢ CNS è—¥ç‰©è¨­è¨ˆæ”¯æ´                                                      â”‚
â”‚                                                                             â”‚
â”‚  4ï¸âƒ£ è‡¨åºŠæ±ºç­–æ”¯æ´                                                            â”‚
â”‚     â€¢ è‡ªå‹•æª¢æ¸¬åŠ‘é‡ä¸è¶³                                                      â”‚
â”‚     â€¢ è² è·åŠ‘é‡è¨ˆç®—                                                          â”‚
â”‚     â€¢ é»æ»´é€Ÿç‡å„ªåŒ–                                                          â”‚
â”‚                                                                             â”‚
â”‚  5ï¸âƒ£ å®‰å…¨æ€§æ•´åˆ                                                              â”‚
â”‚     â€¢ æé†’ç¢ºèªæœ€å¤§å®‰å…¨åŠ‘é‡                                                  â”‚
â”‚     â€¢ æ¨™ç¤ºæ½›åœ¨é¢¨éšª                                                          â”‚
â”‚     â€¢ æ”¯æ´æ²»ç™‚è—¥ç‰©ç›£æ¸¬ (TDM) æ±ºç­–                                           â”‚
â”‚                                                                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## 7. æŠ€è¡“é¸å‹

### 7.1 æ ¸å¿ƒä¾è³´

| çµ„ä»¶ | æŠ€è¡“ | ç”¨é€” | é¸æ“‡ç†ç”± |
|------|------|------|----------|
| **MCP Server** | Python + mcp | MCP å”è­°å¯¦ç¾ | å®˜æ–¹æ”¯æ´ |
| **ç¬¦è™Ÿè¨ˆç®—** | SymPy | æ•¸å­¸ç¬¦è™Ÿé‹ç®— | Python ç”Ÿæ…‹æœ€æˆç†Ÿ |
| **æ•¸å€¼è¨ˆç®—** | NumPy/SciPy | æ•¸å€¼è§£ã€å„ªåŒ– | æ¥­ç•Œæ¨™æº– |
| **å–®ä½è™•ç†** | Pint | ç‰©ç†é‡å–®ä½ | åŠŸèƒ½å®Œæ•´ã€æ˜“ç”¨ |
| **LaTeX è§£æ** | latex2sympy2 | LaTeX â†’ SymPy | å°ˆé–€ç”¨é€” |
| **åŒ–å­¸è¨ˆç®—** | chempy | åŒ–å­¸è¨ˆé‡ | å°ˆé–€ç”¨é€” |

### 7.2 å°ˆæ¡ˆçµæ§‹

```
nsforge-mcp/
â”œâ”€â”€ pyproject.toml              # å°ˆæ¡ˆé…ç½®
â”œâ”€â”€ README.md                   # èªªæ˜æ–‡æª”
â”‚
â”œâ”€â”€ src/
â”‚   â””â”€â”€ nsforge/
â”‚       â”œâ”€â”€ __init__.py
â”‚       â”œâ”€â”€ server.py           # MCP Server ä¸»ç¨‹å¼
â”‚       â”‚
â”‚       â”œâ”€â”€ tools/              # MCP å·¥å…·å®šç¾©
â”‚       â”‚   â”œâ”€â”€ __init__.py
â”‚       â”‚   â”œâ”€â”€ symbolic.py     # symbolic_calculate
â”‚       â”‚   â”œâ”€â”€ physics.py      # physics_formula
â”‚       â”‚   â”œâ”€â”€ chemistry.py    # chemistry_calculate
â”‚       â”‚   â”œâ”€â”€ algorithm.py    # algorithm_analyze
â”‚       â”‚   â””â”€â”€ verify.py       # verify_derivation
â”‚       â”‚
â”‚       â”œâ”€â”€ parsers/            # è§£æå™¨
â”‚       â”‚   â”œâ”€â”€ __init__.py
â”‚       â”‚   â”œâ”€â”€ latex_parser.py
â”‚       â”‚   â”œâ”€â”€ ascii_parser.py
â”‚       â”‚   â””â”€â”€ nl_parser.py    # è‡ªç„¶èªè¨€ï¼ˆå¯é¸ï¼‰
â”‚       â”‚
â”‚       â”œâ”€â”€ engines/            # è¨ˆç®—å¼•æ“
â”‚       â”‚   â”œâ”€â”€ __init__.py
â”‚       â”‚   â”œâ”€â”€ sympy_engine.py
â”‚       â”‚   â”œâ”€â”€ physics_engine.py
â”‚       â”‚   â”œâ”€â”€ chemistry_engine.py
â”‚       â”‚   â””â”€â”€ algorithm_engine.py
â”‚       â”‚
â”‚       â”œâ”€â”€ knowledge/          # çŸ¥è­˜åº«
â”‚       â”‚   â”œâ”€â”€ __init__.py
â”‚       â”‚   â”œâ”€â”€ constants.py    # ç‰©ç†/åŒ–å­¸å¸¸æ•¸
â”‚       â”‚   â”œâ”€â”€ formulas.py     # å…¬å¼æ¨¡æ¿
â”‚       â”‚   â””â”€â”€ rules.py        # æ¨å°è¦å‰‡
â”‚       â”‚
â”‚       â””â”€â”€ utils/              # å·¥å…·å‡½æ•¸
â”‚           â”œâ”€â”€ __init__.py
â”‚           â”œâ”€â”€ formatter.py    # çµæœæ ¼å¼åŒ–
â”‚           â””â”€â”€ validator.py    # è¼¸å…¥é©—è­‰
â”‚
â”œâ”€â”€ tests/                      # æ¸¬è©¦
â”‚   â”œâ”€â”€ test_symbolic.py
â”‚   â”œâ”€â”€ test_physics.py
â”‚   â””â”€â”€ ...
â”‚
â””â”€â”€ docs/                       # æ–‡æª”
    â”œâ”€â”€ api.md
    â””â”€â”€ examples.md
```

### 7.3 ä¾è³´æ¸…å–®

```toml
# pyproject.toml
[project]
name = "nsforge-mcp"
version = "0.1.0"
description = "Neurosymbolic Forge - Where Neural Meets Symbolic"
requires-python = ">=3.10"

dependencies = [
    "mcp>=1.0.0",               # MCP Server SDK
    "sympy>=1.12",              # ç¬¦è™Ÿè¨ˆç®—
    "numpy>=1.24",              # æ•¸å€¼è¨ˆç®—
    "scipy>=1.10",              # ç§‘å­¸è¨ˆç®—
    "pint>=0.22",               # å–®ä½è™•ç†
    "latex2sympy2>=1.9",        # LaTeX è§£æ
    "chempy>=0.8",              # åŒ–å­¸è¨ˆç®—
]

[project.optional-dependencies]
dev = [
    "pytest>=7.0",
    "pytest-asyncio>=0.21",
]
```

---

## 8. å¯¦ä½œè¨ˆåŠƒ

### Phase 1: åŸºç¤æ¶æ§‹ï¼ˆWeek 1-2ï¼‰

- [ ] å»ºç«‹å°ˆæ¡ˆçµæ§‹
- [ ] å¯¦ä½œ MCP Server æ¡†æ¶
- [ ] å¯¦ä½œåŸºæœ¬çš„è¡¨é”å¼è§£æå™¨
- [ ] å¯¦ä½œ SymPy Engine åŸºç¤åŠŸèƒ½

**äº¤ä»˜ç‰©**: å¯é‹è¡Œçš„ MCP Serverï¼Œæ”¯æ´åŸºæœ¬å¾®ç©åˆ†

### Phase 2: æ ¸å¿ƒåŠŸèƒ½ï¼ˆWeek 3-4ï¼‰

- [ ] å®Œæ•´çš„ `symbolic_calculate` å·¥å…·
- [ ] LaTeX è§£ææ”¯æ´
- [ ] æ¨å°æ­¥é©Ÿç”Ÿæˆ
- [ ] çµæœé©—è­‰åŠŸèƒ½

**äº¤ä»˜ç‰©**: å®Œæ•´çš„æ•¸å­¸ç¬¦è™Ÿè¨ˆç®—åŠŸèƒ½

### Phase 3: é ˜åŸŸæ“´å±•ï¼ˆWeek 5-6ï¼‰

- [ ] `physics_formula` å·¥å…·
- [ ] `chemistry_calculate` å·¥å…·
- [ ] çŸ¥è­˜åº«å»ºç«‹ï¼ˆå…¬å¼ã€å¸¸æ•¸ï¼‰

**äº¤ä»˜ç‰©**: ç‰©ç†åŒ–å­¸è¨ˆç®—æ”¯æ´

### Phase 4: é€²éšåŠŸèƒ½ï¼ˆWeek 7-8ï¼‰

- [ ] `algorithm_analyze` å·¥å…·
- [ ] `verify_derivation` å·¥å…·
- [ ] å–®ä½æ›ç®—åŠŸèƒ½
- [ ] éŒ¯èª¤è™•ç†å„ªåŒ–

**äº¤ä»˜ç‰©**: å®Œæ•´çš„ç¬¦è™Ÿæ¨ç† MCP Server

### Phase 5: æ¸¬è©¦èˆ‡æ–‡æª”ï¼ˆWeek 9-10ï¼‰

- [ ] å–®å…ƒæ¸¬è©¦
- [ ] æ•´åˆæ¸¬è©¦
- [ ] API æ–‡æª”
- [ ] ä½¿ç”¨ç¯„ä¾‹

**äº¤ä»˜ç‰©**: ç”Ÿç”¢å°±ç·’ç‰ˆæœ¬

---

## 9. åƒè€ƒè³‡æ–™

### 9.1 æ ¸å¿ƒæ¦‚å¿µ

- [Neural-Symbolic AI](https://arxiv.org/abs/2012.05876) - ç¥ç¶“ç¬¦è™Ÿ AI ç¶œè¿°
- [Wolfram Alpha](https://www.wolframalpha.com/) - è¨ˆç®—çŸ¥è­˜å¼•æ“
- [SymPy Documentation](https://docs.sympy.org/) - ç¬¦è™Ÿè¨ˆç®—åº«

### 9.2 MCP ç›¸é—œ

- [Model Context Protocol](https://modelcontextprotocol.io/) - MCP å®˜æ–¹æ–‡æª”
- [MCP Python SDK](https://github.com/modelcontextprotocol/python-sdk) - Python SDK

### 9.3 ç¬¦è™Ÿè¨ˆç®—

- [Computer Algebra System](https://en.wikipedia.org/wiki/Computer_algebra_system) - è¨ˆç®—æ©Ÿä»£æ•¸ç³»çµ±
- [Symbolic Computation](https://en.wikipedia.org/wiki/Symbolic_computation) - ç¬¦è™Ÿè¨ˆç®—

---

## é™„éŒ„ A: è¡“èªè¡¨

| è¡“èª | è‹±æ–‡ | èªªæ˜ |
|------|------|------|
| ç¬¦è™Ÿæ¨ç† | Symbolic Reasoning | ä½¿ç”¨æ˜ç¢ºç¬¦è™Ÿå’Œè¦å‰‡é€²è¡Œé‚è¼¯é‹ç®— |
| ç¬¦è™Ÿè¨ˆç®— | Symbolic Computation | å°æ•¸å­¸ç¬¦è™Ÿé€²è¡Œä»£æ•¸é‹ç®— |
| ç¥ç¶“ç¬¦è™Ÿ AI | Neural-Symbolic AI | çµåˆç¥ç¶“ç¶²è·¯èˆ‡ç¬¦è™Ÿæ¨ç†çš„ AI |
| AST | Abstract Syntax Tree | æŠ½è±¡èªæ³•æ¨¹ |
| DSL | Domain Specific Language | é ˜åŸŸç‰¹å®šèªè¨€ |
| MCP | Model Context Protocol | æ¨¡å‹ä¸Šä¸‹æ–‡å”è­° |
| CAS | Computer Algebra System | è¨ˆç®—æ©Ÿä»£æ•¸ç³»çµ± |

---

## é™„éŒ„ B: Gap åˆ†æèˆ‡ MVP å®šç¾©

### B.1 èƒ½åŠ›åˆ†å±¤åˆ†æ

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    ç¬¦è™Ÿæ¨å°ç³»çµ±çš„èƒ½åŠ›åˆ†å±¤                                    â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                             â”‚
â”‚  å±¤ç´š          èª°èƒ½åšï¼Ÿ              å¯é æ€§        ç¾æœ‰å·¥å…·                  â”‚
â”‚  â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•   â”‚
â”‚                                                                             â”‚
â”‚  â‘  å…¬å¼è¡¨é”     Agent âœ“              é«˜           LaTeX, SymPy, Lean4       â”‚
â”‚     (éœæ…‹)      äººé¡ âœ“                                                      â”‚
â”‚                                                                             â”‚
â”‚  â‘¡ å–®æ­¥è¨ˆç®—     SymPy âœ“              100%         SymPy, Mathematica        â”‚
â”‚     diff(xÂ³)    Mathematica âœ“                                               â”‚
â”‚                                                                             â”‚
â”‚  â‘¢ æ¨å°è¦åŠƒ     Agent âš ï¸             ä¸ç¢ºå®š       â† é€™æ˜¯ GAPï¼              â”‚
â”‚     ã€Œä¸‹ä¸€æ­¥    äººé¡ âœ“                             æ²’æœ‰é€šç”¨å·¥å…·              â”‚
â”‚      ç”¨ä»€éº¼                                                                 â”‚
â”‚      å…¬å¼ï¼Ÿã€                                                               â”‚
â”‚                                                                             â”‚
â”‚  â‘£ æ¨å°é©—è­‰     Lean4 âœ“              100%         Lean4, Coq, Isabelle      â”‚
â”‚     ã€Œé€™æ­¥å°    äººé¡ âš ï¸                           ï¼ˆä½†éœ€è¦å½¢å¼åŒ–ï¼‰           â”‚
â”‚      ä¸å°ï¼Ÿã€                                                               â”‚
â”‚                                                                             â”‚
â”‚  â‘¤ çµæœè§£é‡‹     Agent âœ“              é«˜           LLM                       â”‚
â”‚                 äººé¡ âœ“                                                      â”‚
â”‚                                                                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### B.2 æ ¸å¿ƒ Gapï¼šæ¨å°è¦åŠƒ

| å·¥å…· | èƒ½åš | ä¸èƒ½åš |
|------|------|--------|
| **SymPy** | åŸ·è¡Œæ¯ä¸€æ­¥è¨ˆç®— | ä¸çŸ¥é“ã€Œä¸‹ä¸€æ­¥è©²åšä»€éº¼ã€ |
| **Lean4** | é©—è­‰æ¯ä¸€æ­¥æ­£ç¢º | ä¸æœƒè‡ªå‹•è¦åŠƒï¼ˆé™¤éæœ‰ tacticï¼‰ |
| **LLM** | è¦åŠƒæ¨å°ç­–ç•¥ | å¯èƒ½å‡ºéŒ¯ã€ç„¡æ³•ä¿è­‰æ­£ç¢º |

### B.3 è§£æ±ºæ–¹æ¡ˆï¼šNeural-Symbolic æ··åˆæ¶æ§‹

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                     å‹™å¯¦çš„ Neural-Symbolic æ–¹æ¡ˆ                             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                             â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                                                           â”‚
â”‚   â”‚   Agent     â”‚ â† åšã€Œæ¨å°è¦åŠƒã€ï¼ˆé¸æ“‡ç­–ç•¥ã€æ±ºå®šæ­¥é©Ÿï¼‰                    â”‚
â”‚   â”‚   (LLM)     â”‚    å¯èƒ½å‡ºéŒ¯ï¼Œä½†å¯ä»¥é€éé©—è­‰ä¿®æ­£                           â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜                                                           â”‚
â”‚          â”‚ è¼¸å‡ºæ¨å°è…³æœ¬ (DSL/YAML)                                          â”‚
â”‚          â–¼                                                                  â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                                                           â”‚
â”‚   â”‚  MCP Server â”‚                                                           â”‚
â”‚   â”‚             â”‚                                                           â”‚
â”‚   â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚   â”‚  â”‚  Derivation Planner                                            â”‚    â”‚
â”‚   â”‚  â”‚  â€¢ å…¬å¼çŸ¥è­˜åœ–è­œï¼ˆçŸ¥é“å…¬å¼ä¹‹é–“çš„ä¾è³´ï¼‰                          â”‚    â”‚
â”‚   â”‚  â”‚  â€¢ æª¢æŸ¥æ­¥é©Ÿæ˜¯å¦åˆç†                                            â”‚    â”‚
â”‚   â”‚  â”‚  â€¢ ç™¼ç¾ç¼ºå°‘çš„è®Šæ•¸                                              â”‚    â”‚
â”‚   â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â”‚   â”‚             â”‚                                                           â”‚
â”‚   â”‚             â–¼                                                           â”‚
â”‚   â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚   â”‚  â”‚  Step Executor (SymPy)                                         â”‚    â”‚
â”‚   â”‚  â”‚  â€¢ åŸ·è¡Œæ¯ä¸€æ­¥è¨ˆç®—ï¼ˆ100% æ­£ç¢ºï¼‰                                 â”‚    â”‚
â”‚   â”‚  â”‚  â€¢ è¨˜éŒ„ä¸­é–“çµæœ                                                â”‚    â”‚
â”‚   â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â”‚   â”‚             â”‚                                                           â”‚
â”‚   â”‚             â–¼                                                           â”‚
â”‚   â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚   â”‚  â”‚  Verifierï¼ˆå¯é¸ï¼šLean4ï¼‰                                       â”‚    â”‚
â”‚   â”‚  â”‚  â€¢ ç¶­åº¦æª¢æŸ¥                                                    â”‚    â”‚
â”‚   â”‚  â”‚  â€¢ åå‘é©—è­‰ï¼ˆå¾®åˆ†é©—ç©åˆ†ï¼‰                                      â”‚    â”‚
â”‚   â”‚  â”‚  â€¢ å½¢å¼è­‰æ˜ï¼ˆLean4 - é€²éšï¼‰                                    â”‚    â”‚
â”‚   â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                                                           â”‚
â”‚          â”‚                                                                  â”‚
â”‚          â–¼                                                                  â”‚
â”‚   é©—è­‰éçš„æ¨å°çµæœï¼ˆå¯è¿½è¹¤ã€å¯é‡ç¾ï¼‰                                        â”‚
â”‚                                                                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### B.4 MVP æœ€å°å¯è¡Œç”¢å“å®šç¾©

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                        MVP æœ€å°å¯è¡Œç”¢å“                                      â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                             â”‚
â”‚  âœ… MVP å¿…åšï¼š                                                               â”‚
â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€    â”‚
â”‚  1. DSL Parser       - è§£æ Agent è¼¸å‡ºçš„æ¨å°è…³æœ¬                            â”‚
â”‚  2. Step Executor    - ç”¨ SymPy åŸ·è¡Œæ¯ä¸€æ­¥                                  â”‚
â”‚  3. Basic Verifier   - ç¶­åº¦æª¢æŸ¥ + åå‘é©—è­‰                                  â”‚
â”‚  4. Formula KB       - å…ˆåš 3-5 å€‹é ˜åŸŸçš„æ ¸å¿ƒå…¬å¼                            â”‚
â”‚  5. MCP Wrapper      - åŒ…è£æˆ Agent å¯å‘¼å«çš„å·¥å…·                            â”‚
â”‚                                                                             â”‚
â”‚  â¸ï¸ æš«ä¸å¯¦ä½œï¼š                                                               â”‚
â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€    â”‚
â”‚  - Lean4 å½¢å¼é©—è­‰ï¼ˆæŠ€è¡“è¤‡é›œåº¦é«˜ï¼‰                                           â”‚
â”‚  - è‡ªå‹•æ¨å°è¦åŠƒï¼ˆè®“ Agent + äººå”ä½œï¼‰                                        â”‚
â”‚  - å®Œæ•´å…¬å¼åº«ï¼ˆå¾é¡Œç›®é€æ­¥æ“´å……ï¼‰                                             â”‚
â”‚                                                                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### B.5 æ¨å°è¦åŠƒç­–ç•¥é¸é …

| é¸é … | å„ªé» | ç¼ºé» | é©ç”¨å ´æ™¯ |
|------|------|------|----------|
| **A. Agent + äºº**ï¼ˆæ¨è–¦ï¼‰ | éˆæ´»ã€å¯è™•ç†å„ç¨®å•é¡Œ | Agent å¯èƒ½é¸éŒ¯ç­–ç•¥ | è¤‡é›œ/æ–°ç©å•é¡Œ |
| **B. é å®šç¾©æ¨¡æ¿** | 100% å¯é  | åªèƒ½è™•ç†å·²çŸ¥å•é¡Œé¡å‹ | æ¨™æº–å•é¡Œ |
| **C. è‡ªå‹•å®šç†è­‰æ˜** | ç†è«–ä¸Šå®Œç¾ | æŠ€è¡“é›£åº¦æ¥µé«˜ | ç ”ç©¶éšæ®µ |

**æ±ºç­–**ï¼šæ¡ç”¨ A + B æ··åˆæ–¹æ¡ˆ - å¸¸è¦‹å•é¡Œç”¨æ¨¡æ¿ï¼Œè¤‡é›œå•é¡Œè®“ Agent è¦åŠƒ + é©—è­‰

### B.6 é©—è­‰å±¤ç´š

| å±¤ç´š | åšæ³• | æˆæœ¬ | MVP ç´å…¥ |
|------|------|------|----------|
| **åŸºæœ¬** | ç¶­åº¦æª¢æŸ¥ + æ•¸å€¼å¸¶å…¥é©—è­‰ | ä½ | âœ… |
| **ä¸­ç­‰** | åå‘é‹ç®—é©—è­‰ï¼ˆå¾®åˆ†é©—ç©åˆ†ï¼‰ | ä¸­ | âœ… |
| **åš´æ ¼** | Lean4 å½¢å¼è­‰æ˜ | é«˜ | âŒ |

---

## é™„éŒ„ C: æ›´æ–°æ—¥èªŒ

| ç‰ˆæœ¬ | æ—¥æœŸ | è®Šæ›´ |
|------|------|------|
| 0.1.0 | 2026-01-01 | åˆå§‹è¨­è¨ˆæ–‡æª” |
| 0.1.1 | 2026-01-01 | æ–°å¢ 6.6 è—¥å‹•å­¸ç¯„ä¾‹ |
| 0.1.2 | 2026-01-01 | æ–°å¢é™„éŒ„ B: Gap åˆ†æèˆ‡ MVP å®šç¾© |
| 0.1.3 | 2026-01-01 | å°ˆæ¡ˆæ›´åç‚º Neurosymbolic Forge (NSForge) |
