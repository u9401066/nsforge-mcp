# SymPy ç¼ºå¤±åŠŸèƒ½å„ªå…ˆåº¦åˆ†æ

> **ç›®æ¨™**ï¼šè­˜åˆ¥ SymPy-MCP å’Œ NSForge éƒ½æ²’æœ‰ï¼Œä½†å° NSForge é ˜åŸŸæœ‰åƒ¹å€¼çš„åŠŸèƒ½  
> **æ—¥æœŸ**ï¼š2026-01-04  
> **é ˜åŸŸ**ï¼šè—¥å‹•å­¸ã€åŒ–å­¸å‹•åŠ›å­¸ã€ç‰©ç†æ¨å°

---

## ğŸ¯ åŸ·è¡Œæ‘˜è¦

### é›™æ–¹ç¼ºå¤±ä½†å€¼å¾—è£œå……çš„åŠŸèƒ½

| å„ªå…ˆåº¦ | åŠŸèƒ½é¡åˆ¥ | å·¥å…·æ•¸ | å¯¦ä½œé›£åº¦ | å½±éŸ¿ç¯„åœ |
|--------|----------|--------|----------|----------|
| ğŸ”¥ **P0** | åŸºç¤ä»£æ•¸ç°¡åŒ– | 7 | ä½ | æ‰€æœ‰é ˜åŸŸ |
| âš¡ **P1** | æœ‰ç†å‡½æ•¸è™•ç† | 3 | ä½ | PK/PD æ¨¡å‹ |
| ğŸ“Š **P2** | ç©åˆ†è®Šæ› | 4 | ä¸­ | å‹•åŠ›å­¸åˆ†æ |
| ğŸ”§ **P3** | è¡¨é”å¼æ”¹å¯« | 1 | ä¸­ | é€šç”¨å·¥å…· |
| ğŸ“ **P4** | æ•¸å€¼ç²¾åº¦æ§åˆ¶ | 1 | ä½ | æ•¸å€¼è¨ˆç®— |

**å»ºè­°ï¼šå„ªå…ˆå¯¦ä½œ P0 + P1 (10 å€‹å·¥å…·)ï¼Œ2-3 å¤©å®Œæˆã€‚**

---

## ğŸ“‹ è©³ç´°åˆ†æ

## P0 - åŸºç¤ä»£æ•¸ç°¡åŒ–ï¼ˆé«˜é »ä½¿ç”¨ï¼‰

### ç‚ºä»€éº¼éœ€è¦ï¼Ÿ

**è—¥å‹•å­¸å ´æ™¯**ï¼š
```python
# å¸¸è¦‹ï¼šåˆä½µè—¥å‹•å­¸æ–¹ç¨‹
C = dose/(V1 + V2) * exp(-k*t)  # å±•é–‹åˆ†å­
C_expanded = dose*exp(-k*t)/(V1 + V2)  # éœ€è¦ expand/simplify

# å¸¸è¦‹ï¼šå› å¼åˆ†è§£æ‰¾é›¶é»
characteristic_eq = s**2 + (k12 + k21 + k10)*s + k21*k10  # éœ€è¦ factor
```

### 7 å€‹å·¥å…·

#### 1. `expand_expression` ğŸ”¥ğŸ”¥ğŸ”¥

**ç”¨é€”**ï¼šå±•é–‹ä»£æ•¸è¡¨é”å¼

```python
# SymPy åŠŸèƒ½
from sympy import expand
expand((x + 1)**2)  # â†’ x**2 + 2*x + 1
expand((x + y)*(x - y))  # â†’ x**2 - y**2
expand(exp(x + y))  # â†’ exp(x)*exp(y)
```

**NSForge ç”¨ä¾‹**ï¼š
- å±•é–‹è¤‡åˆè—¥å‹•å­¸æ–¹ç¨‹
- å¤šéš”å®¤æ¨¡å‹åˆä½µ
- èª¤å·®å‚³æ’­å…¬å¼

**å¯¦ä½œé›£åº¦**ï¼šâ­ (éå¸¸ç°¡å–®ï¼Œç›´æ¥èª¿ç”¨)

---

#### 2. `factor_expression` ğŸ”¥ğŸ”¥ğŸ”¥

**ç”¨é€”**ï¼šå› å¼åˆ†è§£

```python
from sympy import factor
factor(x**2 - 1)  # â†’ (x - 1)*(x + 1)
factor(x**2 + 5*x + 6)  # â†’ (x + 2)*(x + 3)
```

**NSForge ç”¨ä¾‹**ï¼š
- æ‰¾ç‰¹å¾µæ ¹ï¼ˆéš”å®¤æ¨¡å‹ï¼‰
- ç°¡åŒ–è¤‡é›œåˆ†å¼
- ç©©å®šæ€§åˆ†æ

**å¯¦ä½œé›£åº¦**ï¼šâ­ (éå¸¸ç°¡å–®)

---

#### 3. `collect_expression` ğŸ”¥ğŸ”¥

**ç”¨é€”**ï¼šæ”¶é›†åŒé¡é …

```python
from sympy import collect
collect(x*y + x - 3 + 2*x**2, x)  # â†’ 2*x**2 + x*(y + 1) - 3
```

**NSForge ç”¨ä¾‹**ï¼š
- æ•´ç†å¤šé …å¼å½¢å¼
- æº–å‚™æ•¸å€¼è¨ˆç®—
- ä¿‚æ•¸æå–

**å¯¦ä½œé›£åº¦**ï¼šâ­

---

#### 4. `trigsimp_expression` ğŸ”¥ğŸ”¥

**ç”¨é€”**ï¼šä¸‰è§’å‡½æ•¸åŒ–ç°¡

```python
from sympy import trigsimp, sin, cos
trigsimp(sin(x)**2 + cos(x)**2)  # â†’ 1
trigsimp(sin(x)/cos(x))  # â†’ tan(x)
```

**NSForge ç”¨ä¾‹**ï¼š
- åŒ–å­¸å‹•åŠ›å­¸é€±æœŸæŒ¯ç›ª
- ç›¸ä½åˆ†æ
- å‚…ç«‹è‘‰ç´šæ•¸åŒ–ç°¡

**å¯¦ä½œé›£åº¦**ï¼šâ­

---

#### 5. `powsimp_expression` ğŸ”¥

**ç”¨é€”**ï¼šå†ªæ¬¡åŒ–ç°¡

```python
from sympy import powsimp
powsimp(x**2 * x**3)  # â†’ x**5
powsimp((x**a)**b)  # â†’ x**(a*b)
```

**NSForge ç”¨ä¾‹**ï¼š
- æŒ‡æ•¸å¢é•·æ¨¡å‹
- æ¿ƒåº¦å†ªæ¬¡é—œä¿‚
- å–®ä½æ›ç®—

**å¯¦ä½œé›£åº¦**ï¼šâ­

---

#### 6. `radsimp_expression` ğŸ”¥

**ç”¨é€”**ï¼šæ ¹å¼åŒ–ç°¡

```python
from sympy import radsimp, sqrt
radsimp(1/(sqrt(3) + sqrt(2)))  # â†’ -sqrt(2) + sqrt(3)
```

**NSForge ç”¨ä¾‹**ï¼š
- è—¥å‹•å­¸åƒæ•¸ï¼ˆhalf-life å«æ ¹å¼ï¼‰
- æ¨™æº–å·®å…¬å¼
- å¹¾ä½•å¹³å‡

**å¯¦ä½œé›£åº¦**ï¼šâ­

---

#### 7. `combsimp_expression` ğŸ”¥

**ç”¨é€”**ï¼šçµ„åˆå‡½æ•¸åŒ–ç°¡

```python
from sympy import combsimp, factorial
combsimp(factorial(n)/factorial(n - 3))  # â†’ n*(n-1)*(n-2)
```

**NSForge ç”¨ä¾‹**ï¼š
- æ³°å‹’å±•é–‹ä¿‚æ•¸
- çµ±è¨ˆå…¬å¼
- ç´šæ•¸æ±‚å’Œ

**å¯¦ä½œé›£åº¦**ï¼šâ­

---

## P1 - æœ‰ç†å‡½æ•¸è™•ç†ï¼ˆPK/PD æ¨¡å‹å¸¸ç”¨ï¼‰

### ç‚ºä»€éº¼éœ€è¦ï¼Ÿ

**è—¥å‹•å­¸æ¨¡å‹å¸¸æ˜¯æœ‰ç†å‡½æ•¸**ï¼š
```python
# Michaelis-Menten
v = V_max * S / (K_m + S)  # éœ€è¦ apart, cancel

# å…©éš”å®¤æ¨¡å‹å‚³éå‡½æ•¸
C(s) = dose * (k12*k21) / ((s + Î»1) * (s + Î»2))  # éœ€è¦ apart åšå Laplace
```

### 3 å€‹å·¥å…·

#### 8. `apart_expression` ğŸ”¥ğŸ”¥ğŸ”¥

**ç”¨é€”**ï¼šéƒ¨åˆ†åˆ†å¼åˆ†è§£

```python
from sympy import apart
apart((x**2 + 3*x + 2)/(x**2 + 5*x + 6), x)  # â†’ 1 - 2/(x + 3)
```

**NSForge ç”¨ä¾‹**ï¼š
- å Laplace è®Šæ›æº–å‚™
- å¤šéš”å®¤æ¨¡å‹åˆ†è§£
- ç©åˆ†ç°¡åŒ–

**å¯¦ä½œé›£åº¦**ï¼šâ­

---

#### 9. `cancel_expression` ğŸ”¥ğŸ”¥

**ç”¨é€”**ï¼šç´„åˆ†æœ‰ç†å¼

```python
from sympy import cancel
cancel((x**2 - 1)/(x - 1))  # â†’ x + 1
```

**NSForge ç”¨ä¾‹**ï¼š
- ç°¡åŒ–è—¥å‹•å­¸åˆ†å¼
- æ¶ˆé™¤å¥‡é»
- æ•¸å€¼ç©©å®šæ€§

**å¯¦ä½œé›£åº¦**ï¼šâ­

---

#### 10. `together_expression` ğŸ”¥

**ç”¨é€”**ï¼šåˆä½µåˆ†å¼

```python
from sympy import together
together(1/x + 1/y)  # â†’ (x + y)/(x*y)
```

**NSForge ç”¨ä¾‹**ï¼š
- åˆä½µæ¸…é™¤ç‡
- ç¸½ç”Ÿç‰©åˆ©ç”¨åº¦
- å¤šé€”å¾‘çµ¦è—¥

**å¯¦ä½œé›£åº¦**ï¼šâ­

---

## P2 - ç©åˆ†è®Šæ›ï¼ˆå‹•åŠ›å­¸åˆ†æï¼‰

### ç‚ºä»€éº¼éœ€è¦ï¼Ÿ

**å‹•åŠ›å­¸ç³»çµ±å¸¸ç”¨è®Šæ›åŸŸåˆ†æ**ï¼š
```python
# è—¥å‹•å­¸ï¼šLaplace åŸŸå‚³éå‡½æ•¸
C(s) = dose / (V * (s + k))  # s-domain

# é€±æœŸçµ¦è—¥ï¼šFourier åˆ†æ
C(Ï‰) = Fourier[C(t)]  # frequency domain
```

### 4 å€‹å·¥å…·

#### 11. `laplace_transform` ğŸ”¥ğŸ”¥

**ç”¨é€”**ï¼šLaplace è®Šæ›

```python
from sympy import laplace_transform
from sympy.abc import t, s
laplace_transform(exp(-k*t), t, s)  # â†’ 1/(s + k)
```

**NSForge ç”¨ä¾‹**ï¼š
- ODE è½‰ä»£æ•¸æ–¹ç¨‹
- ç©©å®šæ€§åˆ†æ
- ç³»çµ±éŸ¿æ‡‰

**å¯¦ä½œé›£åº¦**ï¼šâ­â­ (éœ€è¦è™•ç†æ¢ä»¶)

---

#### 12. `inverse_laplace_transform` ğŸ”¥ğŸ”¥

**ç”¨é€”**ï¼šå Laplace è®Šæ›

```python
from sympy import inverse_laplace_transform
inverse_laplace_transform(1/(s + k), s, t)  # â†’ exp(-k*t)
```

**NSForge ç”¨ä¾‹**ï¼š
- å¾å‚³éå‡½æ•¸å›æ™‚åŸŸ
- å¤šéš”å®¤æ¨¡å‹è§£æè§£
- è„ˆè¡éŸ¿æ‡‰

**å¯¦ä½œé›£åº¦**ï¼šâ­â­

---

#### 13. `fourier_transform` ğŸ”¥

**ç”¨é€”**ï¼šFourier è®Šæ›

```python
from sympy import fourier_transform
from sympy.abc import x, k
fourier_transform(exp(-x**2), x, k)  # â†’ sqrt(pi)*exp(-pi**2*k**2)
```

**NSForge ç”¨ä¾‹**ï¼š
- é€±æœŸçµ¦è—¥åˆ†æ
- é »è­œåˆ†æ
- ä¿¡è™Ÿè™•ç†

**å¯¦ä½œé›£åº¦**ï¼šâ­â­

---

#### 14. `inverse_fourier_transform` ğŸ”¥

**ç”¨é€”**ï¼šå Fourier è®Šæ›

```python
from sympy import inverse_fourier_transform
```

**NSForge ç”¨ä¾‹**ï¼š
- é »åŸŸå›æ™‚åŸŸ
- æ¿¾æ³¢å™¨è¨­è¨ˆ

**å¯¦ä½œé›£åº¦**ï¼šâ­â­

---

## P3 - è¡¨é”å¼æ”¹å¯«ï¼ˆé€šç”¨å·¥å…·ï¼‰

### 15. `rewrite_expression` ğŸ”¥

**ç”¨é€”**ï¼šè¡¨é”å¼å½¢å¼è½‰æ›

```python
from sympy import exp, I, sin, cos, tan
exp(I*x).rewrite(sin)  # â†’ sin(x) + I*cos(x)
tan(x).rewrite(sin)  # â†’ sin(x)/cos(x)
```

**NSForge ç”¨ä¾‹**ï¼š
- æŒ‡æ•¸è½‰ä¸‰è§’ï¼ˆEuler å…¬å¼ï¼‰
- è¤‡æ•¸è½‰å¯¦æ•¸å½¢å¼
- å‡½æ•¸è½‰æ›

**å¯¦ä½œé›£åº¦**ï¼šâ­â­ (éœ€è¦é¸æ“‡ç›®æ¨™)

---

## P4 - æ•¸å€¼ç²¾åº¦æ§åˆ¶

### 16. `evaluate_numeric_precision` ğŸ”¥

**ç”¨é€”**ï¼šé«˜ç²¾åº¦æ•¸å€¼è¨ˆç®—

```python
from sympy import N, pi
N(pi, 50)  # â†’ 3.1415926535897932384626433832795028841971693993751
```

**NSForge ç”¨ä¾‹**ï¼š
- é«˜ç²¾åº¦è—¥å‹•å­¸åƒæ•¸
- é¿å…æµ®é»èª¤å·®
- æ•æ„Ÿæ€§åˆ†æ

**å¯¦ä½œé›£åº¦**ï¼šâ­ (NSForge å·²æœ‰ `evaluate_numeric`ï¼Œéœ€å¢å¼·)

---

## âŒ ä¸å»ºè­°è£œå……çš„åŠŸèƒ½

### 1. å¹¾ä½•æ¨¡çµ„ (`sympy.geometry`)

**ç‚ºä»€éº¼ä¸éœ€è¦**ï¼š
- NSForge å®šä½ï¼šæ¨å°å¼•æ“ï¼Œéå¹¾ä½•å·¥å…·
- ä½¿ç”¨å ´æ™¯ï¼šæ¥µå°‘æ¶‰åŠå¹³é¢å¹¾ä½•
- æ›¿ä»£æ–¹æ¡ˆï¼šå°ˆç”¨ CAD/å¹¾ä½•è»Ÿé«”

### 2. é‚è¼¯æ¨¡çµ„ (`sympy.logic`)

**ç‚ºä»€éº¼ä¸éœ€è¦**ï¼š
- ç”¨é€”ï¼šå¸ƒæ—é›»è·¯ã€æ•¸ä½é‚è¼¯
- NSForge å®šä½ï¼šé€£çºŒæ•¸å­¸æ¨å°
- æ›¿ä»£æ–¹æ¡ˆï¼šLean4 å½¢å¼é©—è­‰ï¼ˆæœªä¾†ï¼‰

### 3. é›†åˆè«– (`sympy.sets`)

**ç‚ºä»€éº¼ä¸éœ€è¦**ï¼š
- ä½¿ç”¨é »ç‡ï¼šä½
- æ›¿ä»£æ–¹æ¡ˆï¼šä¸ç­‰å¼æ±‚è§£å™¨ï¼ˆNSForge å·²æœ‰ï¼‰

### 4. çµ„åˆæ•¸å­¸ (`sympy.combinatorics`)

**ç‚ºä»€éº¼ä¸éœ€è¦**ï¼š
- ç”¨é€”ï¼šç¾¤è«–ã€æ’åˆ—çµ„åˆ
- NSForge å®šä½ï¼šé€£çºŒç³»çµ±
- æ›¿ä»£æ–¹æ¡ˆï¼šå°ˆç”¨çµ„åˆå·¥å…·

### 5. æ•¸è«– (`sympy.ntheory`)

**ç‚ºä»€éº¼ä¸éœ€è¦**ï¼š
- ç”¨é€”ï¼šè³ªæ•¸ã€æ¨¡é‹ç®—
- NSForge å®šä½ï¼šå¯¦æ•¸åŸŸæ¨å°
- æ›¿ä»£æ–¹æ¡ˆï¼šæ•¸è«–å°ˆç”¨åº«

---

## ğŸ“¦ å¯¦ä½œè¨ˆç•«

### Phase 1: P0 åŸºç¤ä»£æ•¸ï¼ˆ2 å¤©ï¼‰

**7 å€‹å·¥å…·**ï¼Œæ¯å€‹ 2-3 å°æ™‚ï¼š

```python
# src/nsforge_mcp/tools/calculate.py

@mcp.tool()
def expand_expression(expr: str, **options) -> dict[str, Any]:
    """å±•é–‹ä»£æ•¸è¡¨é”å¼
    
    Examples:
        expand_expression("(x+1)**2")  # â†’ x**2 + 2*x + 1
        expand_expression("exp(x+y)")  # â†’ exp(x)*exp(y)
    """
    from sympy import expand, sympify
    expr_obj = sympify(expr)
    result = expand(expr_obj, **options)
    return {
        "success": True,
        "result": str(result),
        "latex": latex(result)
    }

@mcp.tool()
def factor_expression(expr: str, **options) -> dict[str, Any]:
    """å› å¼åˆ†è§£
    
    Examples:
        factor_expression("x**2 - 1")  # â†’ (x-1)*(x+1)
    """
    from sympy import factor, sympify
    expr_obj = sympify(expr)
    result = factor(expr_obj, **options)
    return {
        "success": True,
        "result": str(result),
        "latex": latex(result)
    }

# ... é¡ä¼¼å¯¦ä½œå…¶ä»– 5 å€‹
```

### Phase 2: P1 æœ‰ç†å‡½æ•¸ï¼ˆ1 å¤©ï¼‰

**3 å€‹å·¥å…·**ï¼š`apart`, `cancel`, `together`

### Phase 3: P2 ç©åˆ†è®Šæ›ï¼ˆå¯é¸ï¼Œ3-5 å¤©ï¼‰

**4 å€‹å·¥å…·**ï¼šéœ€è¦æ›´å¤šæ¸¬è©¦å’Œé‚Šç•Œè™•ç†

### Phase 4: P3-P4ï¼ˆå¯é¸ï¼Œ1 å¤©ï¼‰

**2 å€‹å·¥å…·**

---

## ğŸ¯ å„ªå…ˆåº¦ç¸½çµ

### å¿…åšï¼ˆP0 + P1ï¼‰

| å·¥å…· | åƒ¹å€¼ | é›£åº¦ | æ™‚é–“ |
|------|------|------|------|
| `expand_expression` | â­â­â­â­â­ | â­ | 2h |
| `factor_expression` | â­â­â­â­â­ | â­ | 2h |
| `apart_expression` | â­â­â­â­â­ | â­ | 2h |
| `cancel_expression` | â­â­â­â­ | â­ | 2h |
| `collect_expression` | â­â­â­â­ | â­ | 2h |
| `trigsimp_expression` | â­â­â­â­ | â­ | 2h |
| `together_expression` | â­â­â­ | â­ | 2h |
| `powsimp_expression` | â­â­â­ | â­ | 2h |
| `radsimp_expression` | â­â­â­ | â­ | 2h |
| `combsimp_expression` | â­â­ | â­ | 2h |

**ç¸½æ™‚é–“ï¼š2-3 å¤©**

### å¯é¸ï¼ˆP2-P4ï¼‰

æ ¹æ“šç”¨æˆ¶åé¥‹æ±ºå®šæ˜¯å¦å¯¦ä½œã€‚

---

## ğŸ“Š èˆ‡ç¾æœ‰åŠŸèƒ½å°æ¯”

### ç¾æœ‰ç°¡åŒ–åŠŸèƒ½

| ç¾æœ‰ | æ–°å¢ | å·®ç•° |
|------|------|------|
| `derivation_simplify` | `expand_expression` | simplify æ˜¯å•Ÿç™¼å¼ï¼Œexpand æ˜¯ç¢ºå®šæ€§ |
| - | `factor_expression` | å…¨æ–°åŠŸèƒ½ |
| `simplify_expression` (SymPy-MCP) | 7 å€‹å°ˆé–€åŒ–å·¥å…· | æ›´ç²¾ç¢ºæ§åˆ¶ |

### ç‚ºä»€éº¼ä¸ç›´æ¥ç”¨ `simplify`ï¼Ÿ

```python
# simplify æ˜¯é»‘ç›’å­
simplify((x+1)**2)  # å¯èƒ½æ˜¯ (x+1)**2 æˆ– x**2+2*x+1ï¼Œä¸ç¢ºå®š

# expand æ˜¯ç¢ºå®šæ€§
expand((x+1)**2)  # ä¸€å®šæ˜¯ x**2 + 2*x + 1

# ç”¨æˆ¶éœ€è¦ç²¾ç¢ºæ§åˆ¶ï¼š
# "æˆ‘è¦å±•é–‹" â†’ expand
# "æˆ‘è¦å› å¼åˆ†è§£" â†’ factor
# "æˆ‘ä¸çŸ¥é“è¦ä»€éº¼" â†’ simplify
```

---

## ğŸš€ è¡Œå‹•é …

### ç«‹å³ï¼ˆæœ¬é€±ï¼‰

1. **å¯¦ä½œ P0 å‰ 3 å€‹**ï¼ˆexpand, factor, collectï¼‰
2. **æ¸¬è©¦è—¥å‹•å­¸ç”¨ä¾‹**
3. **æ›´æ–°æ–‡æª”**

### ä¸‹é€±

4. **å¯¦ä½œ P0 å‰©é¤˜ + P1**
5. **ç”¨æˆ¶æ¸¬è©¦åé¥‹**

### è©•ä¼°

6. **æ ¹æ“šéœ€æ±‚æ±ºå®š P2-P4**

---

*åˆ†æå®Œæˆæ–¼ 2026-01-04*  
*ä¸‹ä¸€æ­¥ï¼šå¯¦ä½œ P0 åŸºç¤ä»£æ•¸å·¥å…·*
